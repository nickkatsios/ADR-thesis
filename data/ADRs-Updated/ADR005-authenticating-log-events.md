# ADR005: Authenticating log events

## Context

We need to verify that the log event sent to the Adapter matches the URL used
to sent the request.

The Broker must generate an Adapter URL that is unique to an application.

The Broker must generate an Adapter URL in a way that is not easily tampered with (ie /my-app-name).

The Broker should be stateless.

The Adapter must verify that the application GUID in the log event is valid for the URL used to send the event.

The Adapter should be stateless.

## Decision

We will have the Broker generate URLs containing the a
[hash-based message authentication code][hmac] of the application GUID an a
secret shared between the Broker and the Adapter.

## Consequences

By including an HMAC that requires knowledge of both the hard to guess tenant
application GUID and the shared secret the Adapter can verify that the URL was
generated by the Broker and reject attempts to ship log event for unexpected
application GUIDs.

By including all the information required in the URL, the URL itself should be
considered a secret by the tenant.

[hmac]: https://en.wikipedia.org/wiki/HMAC
