# Migrating from JSPs and GSPs
- Start Date: 2019/05/10
- RFC PR: https://github.com/openmrs/openmrs-rfc-frontend/pull/5

## Decision, including impact on distributions
Existing server rendered pages, including JSPs, GSPs,
[the reference application](https://github.com/openmrs/openmrs-module-referenceapplication), and
[legacyui](https://github.com/openmrs/openmrs-module-legacyui) will be migrated away from, with
the following migration path:

1) Tomcat will be configured to return an HTTP 200 status and the [OpenMRS SPA](/text/0001-single-page-applications.md)
HTML content for any incoming requests that do not have a corresponding JSP, GSP, or servlet.
2) Distributions that use server rendered JSPs/GSPs will link to the OpenMRS SPA for any functionality within the
SPA that they want to use. Navigation to the SPA is a full page reload.
3) Distributions will configure/modify the OpenMRS SPA so that it links back to JSPs/GSPs for the functionality
that is not yet in the SPA. Navigation to the server rendered pages will also be a full page reload.
4) When enough functionality exists within the SPA to justify a switch, distributions will switch their
landing/home pages to the SPA, making it the default UI that links to server rendered pages as needed.
5) Over time, distributions will remove JSPs/GSPs in favor of reusing or building their own functionality
within the SPA. The process of doing so will take time, but can be done piecemeal by changing one
nav link at a time, within the JSPs/GSPs and SPA. Migrating a single server rendered page is done by
changing links to that page so that users are redirected to the SPA instead of the server rendered page.
6) If, after much migration effort and time, a distribution removes all of their server rendered pages,
they will turn off JSPs/GSPs in favor of only using functionality within the SPA.

## Definition
Migration refers to, over time, no longer using JSPs and GSPs in favor of the OpenMRS SPA.

A server rendered page is an HTML file that is generated by a server for a specific URL.

An SPA is a single page application, as [defined here](/text/0001-single-page-applications.md).

[JSP](https://en.wikipedia.org/wiki/JavaServer_Pages) and [GSP](https://gsp.grails.org/latest/guide/index.html) are 
ways of building server rendered pages within a [Tomcat](https://en.wikipedia.org/wiki/Apache_Tomcat) server (in our case,
[openmrs-core](https://github.com/openmrs/openmrs-core/) is our Tomcat server).

A full page reload is when the user clicks on a link and the browser unloads the current page, asking the server to send new HTML.

## Reason for decision
- See [An Amazing Future for OpenMRS](https://talk.openmrs.org/t/an-amazing-future-for-openmrs/22328/1) for some thoughts from Burke
on moving away from JSPs/GSPs.
- See [reasons for a single page application](/text/0001-single-page-applications.md#reason-for-decision).

## Alternatives
OpenMRS and its distributions could remain implemented in JSPs and GSPs, even though they are older technologies.

Distributions could do what they have done in the past and implement an SPA of their own that does not use server
rendering technologies. However, that is what happened in that past that resulted each distribution re-implementing
all of the core functionality of an EMR, without being able to share their code.

## Common practices (not enforced)
- Treat your JSPs and GSPs as "maintenance-only" mode. When substantial changes are to be made to a JSP or GSP, consider
doing a piecemeal rewrite of just that page into the OpenMRS SPA.
- Try to reach Step 4 (as described above) as soon as possible, since that represents a shift in where user and developer
attention is focused.