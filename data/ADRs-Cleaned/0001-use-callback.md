callback public api public api callback intercept file modification php watchermonitorpaths function modifiedfile file something promise based api would better php stream watchermonitorpaths null modifiedfile yield streamwait something problem internals code far complicated manage backlog strategy involve multiple process read stream example find watcher would maintain state find process return one promise time process may return multiple file time maintain queue file modification next call wait another simple amp solution emitter case api would consumed php iterator watcherwatchpaths yield iteratoradvance modifiedfile iteratorgetcurrent something complexity callback solution api doesnt seem much better least callback type hint keep simple callback interface consequence best api keep rest code simple relatively easy understand