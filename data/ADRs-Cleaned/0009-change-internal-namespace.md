change dns internal service discovery better support currently hard filter internal suffix service discovery namespaces route resolver dns firewall domain name part present issue multiple ephemeral environment aws dev account setting rule detail route reolver dns firewall see httpsdocsawsamazoncomroutelatestdeveloperguideresolverdnsfirewallhtml detail service discovery private namespaces see httpsdocsawsamazoncomamazonecslatestdeveloperguideservicediscoveryhtml proposal order proper filtering dns firewall change dns entry service discovery easier support propose changed current format bash apienvironmentnameinternal format regex ephemeralnameindevonlyaccountnameopgservicenameinstancenameservicetypeinternal bash productionopglpaapiecsinternal production abcddevelopmentopglpaapiecsinternal dev give better tracking thing within stack allow thing like dns egress filtering granular fashion component part domain follows ephemeralnameindevonly optional refers ephemeral environment name defined terraform prefixing present accountname development accountname refers designated account production preproduction development servicename refers service name lpa instancename refers instance name inside service api servicetype refers aws service type mean filter allowed accountnameopgservicenameinstancenameservicetypeinternal egress dns firewall benefit making namespace canonical represents entry internal also identifying aws account alias come development account initially run proven follow non development account availability downtime change require api service recreated reviewed adjusted based consultation webops community practice member opg document opg technical guidance adr accordingly final apis domain service discovery aws exposed external service internal ephemeralnameindevonlyaccountnameopgservicenameinstancenameservicetypeinternal suffix domain name consequence able filter anything end accountnameopgservicenameinstancenameservicetypeinternal dns firewall rule require time non development accountsenvironment existing set mitigated performing change maintenance window