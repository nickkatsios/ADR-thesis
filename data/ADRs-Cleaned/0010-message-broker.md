layout default title adr navorder permalink record message broker asynchronous messaging drafted deciders list everyone involved drafted problem statement sdr evolving increasing set largely singlepurpose service communication service occurring via synchronous http architecture fragile scale load number service increase service must knowledge many service service depends many service perform job service unavailable bring service hamper performance synchronous http performance penalty operation response required reporting event stanford network notoriously unreliable especially night significant coding effort required account addition already place within sdr reinvented message broker andor jerryrigged around message broker polling via http determine longrunning job completed introducing message broker support asynchronous communication appropriate allow decoupling service making sdr resilient scalable example specific example message broker could introduced existing infrastructure event logging currently various service log event service http call make service dependent event service requires service unnecessarily wait event service logging event alternatively service could submit event message message describes event logged message broker message broker would add message event queue event service could subscribe event queue logging event event message approach event service offline running slowly service affected workflow step processing currently service want process workflow step knowledge workflow service workflow step recorded workflow service updated step started completed robot dor service app interact workflow service way situation even worse certain workflow step step initiated robot completed dor service app robot making call dor service app invoke step alternatively workflow step could submit job request message message describes job performed message broker message broker would add message job request topic queue topic identifies type job example technicalmetadata multiple service subscribe queue filtering topic handle example dor service app may select sdr ingest transfer message upon receiving message service would emit job started message perform work emit job completed message message broker would add message job queue workflow service could subscribe job queue updating workflow step job started job completed message imagine future technical metadata service added could start handling message technical metadata topic service would knowledge workflow service though immediate also allows possibility service requesting job without know service perform job service perform job knowing new service approach binding service reduced considered add message broker rabbitmq leave note version activemq currently deployed considered viable activemq legacy technology tightly bound java outcome tbd positive consequence increased ability scale number service increased ability scale load increased resilience service failure provide mechanism notification completion longrunning job negative consequence message broker must supported ops service become dependent message broker however message broker typically designed depended evolution work begin message broker technology selection rabbitmq recommended message broker implementation rabbitmq satisfies following requirement support multiple messaging pattern particular direct fanout topic support message acknowledgment support persistable message queue support json message ruby client available puppet deployment available docker image available high availabability clustering configuration available management provided excellent community documentation widely deployed course open source