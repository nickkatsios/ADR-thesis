determine display facility map open apparel registry currently includes facility performance reason paginated facility data api endpoint data return maximum result single request turn mean frontend client ever display maximum facility time rendered clustered leaflet marker via reactleaflet facility api request currently filtered django querysets whose input querystring parameter included api request enable user view oar facility map simultaneously well update api return facility display client render map present mean updating application display facility simultaneously following upcoming msi integration work anticipate number oar facility increase around application able map addition also want user able filter vector tile query parameter like contributor facility name country along map bounding box accomplish decided vector tile generated ultimately postgiss stasmvt function rendering frontend leaflet vector grid possibly via reactleafletvectorgrid weve decided vector tile cluster facility zoom level would limit number actual point frontend display given time adr document subsequent setting dedicated stasmvtbased vector tile server like martin adding new vector tile endpoint existing django web application would make stasmvt query four rejected landing stasmvtbased solution consider ultimately rejected outright reusing existing facility api endpoint theory could remove maxpagesize limit facility api endpoint practice would cause performance problem size geojson response number leaflet marker increased web app would serialize ten thousand marker request geojson payload request could several megabyte size client would put ten thousand leaflet marker browser memory windshaft could potentially combination windshaft leafletutfgrid render facility wasnt much enthusiasm setting maintaining windshaft tiler specific reason windshaft requires adding another service windshaft pretty costly configure maintain windshafts documentation isnt great creating static vector tile ruled idea creating static set vector tile oar facility data change frequently lambda function tiler azavea undertaken research work determine viability tiler based lambda function connect postgis call stasmvt however research discovered limit approach dealing function warmup time handling concurrent database connection two stasmvtbased approach stasmvtbased approach generate vector tile dynamically seemed promising vector tile working group report note uncertainty around performant would generate tile postgis oar traffic may encounter performance problem could emerge higher traffic site considered two way generate tile stasmvt dedicated vector tile server like martin trex tegola adding vector tile endpoint existing django web app martin trex tegola vector tile server martin trex tegola opensource vector tile server connect directly postgis render vector tile judging documentation appear fairly straightforward configure operate slightly different api considered martin seriously part good documentation around write plpgsql function requesting tile data filtered set query parameter here martin function source example plpgsql create replace function publicfunctionsourcez integer integer integer queryparams json return bytea declare bound geometrypolygon tilebboxz mvt bytea begin select mvt stasmvttile publicfunctionsource geom select stasmvtgeomgeom bound true geom publictablesource geom bound tile geom null return mvt end language plpgsql immutable strict parallel safe pro configuration martin appears fairly straightforward configure documentation encompassed wed want performance martin tout suitable large database indicates might obviate performance concern around stasmvt con plpgsql function source since martin plpgsql function filtering would rewrite facility filtering logic currently exists django querysets web app work plpgsql moreover time added new filter search web application wed write version query plpgsql tiler security martin queryparams appear passed database string open security hole could create postgis role user limited readonly set permission solely martin instance requires taking additional risk complexity likewise adding postgisbased security tiler may also compel figure duplicate feature like api key authentication facilitiesdata request logging weve already written django unfamiliarity dont experience running martin production weve also got limited experience rust language martin written together mean martinbased tile server may difficult operate debug adding vector tile endpoint existing django web app adding vector tile endpoint existing web app seemed like promising approach since would enable trying stasmvt reusing apps database connection djangos querysets filtering approach would add tilelayerzxy endpoint django application update client make tile request rather rendering facility geojson response leaflet marker pro provides access existing django queryset apparatus martin similar solution would compel writing new version facility query plpgsql placing vector tile endpoint django let reuse existing query code also provides access django model querysets likewise would write new code new filter search two different language already secure database connection django web application already secure database connection would create solution securing martin another postgisbacked tile server enables switching stasmvt another python vector tile remains question viability stasmvt turn performant solution tile endpoint django make possible drop stasmvt altogether switch alternate python library generating vector tile doesnt require creating deploying different service adding martin another vector tile server would increase number different kind service running part oar add application complexity keeping tile endpoint django require adding new service allows scaling increasing number app instance adding tile endpoint django app also enables continuing scale application usual way increasing number app instance available serve request con mingles tile request traffic app traffic biggest downside adding vector tile endpoint django app would mean mingling tile request traffic app traffic plan limit size tile request response clusting facility different zoom level tile request traffic likely frequent sustained request current facility endpoint decided add vector tile endpoint existing django app martin particular seemed like compelling solution enough open question discourage taking complexity main apprehension adding tile endpoint existing web app itll mingle tile request request way could cause performance problem however given size oar traffic possibility addressing traffic increase scaling number app instance seemed like acceptable tradeoff consequence consequence add new tile endpoint api determine aggregation strategy clustering facility different zoom level adjust leaflet map tile endpoint determine symbology make necessary adjustment frontend sending selected filter search tile endpoint determine whether adjust gunicorn configuration change number worker per instance worker type decide whether add caching http header tile replicate change cloudfront