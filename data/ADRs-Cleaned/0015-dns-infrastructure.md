dns infrastructure instance able resolve internal infrastructure service puppet graphite logstash service application endpoint exposed internet resolved public dns instance alertsintegration deployintegration wwworigin etc want able create new piece infrastructure alongside current piece infrastructure ability test direct access piece dns endpoint want control stack running active version piece infrastructure control application connect dns want ensure site link work correctly user browse publishing publishingservicegovuk domain stack domain stack internal external dns domain terraform project stack add record route zone expose service internally andor externally instance green stack greeninternalrootdomain greenexternalrootdomain domain puppet icinga service stack add puppetgreeninternalrootdomain alertsgreenexternalrootdomain route infrastructure level view application work correctly across independent stack correctly work publishing domain root domain service record service entry root domain point stack record entry updated select active version service instance machine puppet service puppetinternalrootdomain cname puppetgreeninternalrootdomain point new puppet stack blue provisioned test new version tested switch cname new stack puppetinternalrootdomain resolve puppetblueinternalrootdomain external route zone public external route zone manage external root domain stack also external route zone delegate stack subdomain instance setting new environment public root domain testgovukdigital create new stack green well zone testgovukdigital zone stack subdomain greentestgovukdigital store stack record internal route zone internal domain cannot replicate external configuration possible dns delegation internal zone vpc domain overlap instance previous scenario internal zone root domain testgovukinternaldigital cannot create delegate subdomain zone greentestgovukinternaldigital vpc overlap root domain case internal domain single zone well still keep domain schema stack generate record appending stack subdomain consequence initially manage entry root domain manually