adr dont inquiry notification working towards private beta pay working towards implementing handling worldpay refund notification made previously make inquiry api call worldpay receiving notification main motivation security case forged notification worldpay confident getting accurate information calling worldpay robustness notification missed reason inquiry allow catch new regarding refund determined worldpay api support inquiry specific refund order sample response inquiry refund occured xml xml version encodingutf doctype paymentservice public worldpaydtd worldpay paymentservice ven httpdtdworldpaycompaymentservicevdtd paymentservice version merchantcodemerchantcode reply orderstatus ordercodeebfecaaefffd payment paymentmethodvisasslpaymentmethod paymentmethoddetail card typecreditcard paymentmethoddetail amount value currencycodegbp exponent debitcreditindicatorcredit lasteventrefundedlastevent refundreferencerefundebfecaaefffdrefundreference referencerefundebfecaaefffdreference authorisationid cvcresultcode descriptionnot sent acquirer avsresultcode descriptionnot sent acquirer cardholdernamecdatamr paymentcardholdername issuercountrycodenaissuercountrycode balance accounttypesettledbibitcommission amount value currencycodegbp exponent debitcreditindicatorcredit balance balance accounttypesettledbibitnet amount value currencycodegbp exponent debitcreditindicatorcredit balance riskscore value payment dayofmonth month year hour minute second orderstatus reply paymentservice inquiry command return information last event order lasteventrefundedlastevent case order two partial refund there race condition inquiry could return information different refund conducting inquiry notification add significant complexity codebase particular open possqibility lot edge case example enquiry might indicate different notification could theory legitimate two change occured quick succession first notification delivered could indicate bug issue hard know sensibly handle edge case dont really evidence happen practice there issue current implementation performs inquiry thread handle notification http request mean notification doesnt get http response inquiry roundtrip worldpay also completed could potential source bug finally worldpay advise order modification inquiry guide although order inquiry useful tool recommend order notification find change transaction youre set notification work notification sent automatically transaction change inquiry call notification neither order notification refund notification consequence agreed possible benefit performing inquiry justify significant added complexity removing simplify codebase test vigilant unexpected change might indicate missed notification detected charge transition state machine currently raise unhandled exception trigger error probably want change error logged return code regarding payment gateway smartpay doesnt support order inquiry relevant integrating gateway reconsider appropriate approach casebycase basis