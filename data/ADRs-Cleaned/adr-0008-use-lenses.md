adr lens writing game lot nested state update traverse otherwise manipulate querying data relatively straightforward vanilla haskell updating nested record pain problem lens supposed help additionally lens classy lens style let individual subsystem game target subset state monad instead requiring full state lens time consequence going figure way organising class lens definition method deal overlapping name