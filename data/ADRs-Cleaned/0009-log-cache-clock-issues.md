log cache clock issue issue motivating influence constrains cli previously traffic controller retrieve application log implemented longlived websocket connection log streamed client migration log cache needed preserve experience streaming log built api timestamped log envelope retrieved via http request two main question needed answer oldest log shown application may log previous push already present log cache relate current staging operation would want show log current staging operation newest log shown log cache eventually consistent recent log may order incomplete would want show log settled log log cache long enough converge also needed answer question regarding log recent want define range settled log show want show everything currently log cache change proposing agreed implement determine oldest log shown peek latest log within log cache application read point determine newest log shown show log envelope timestamp two second old log recent always show log currently log cache regardless whether settled peeking latest log initial cli implementation log cache started reading log cache offset based current client clock time flawed incorrectly configured client clock would result unexpected behaviour client clock ahead server either log would shown would lengthy delay log would shown client clock behind server log relating previous operation might shown attempt decouple client clock time instead peek timestamp latest log envelope application timestamp starting point envelope present application continue retry envelope become available delaying output new log default log cache client return log envelope timestamps second old see code filtering mechanism known walkdelay configurable testing found default one second sufficient allow log cache settle resulted log loss foundation multiple log cache node multiple log cache node may ingesting event application single log cache node host cache given application possible see newer log envelope timestamp move timestamp cursor forward received earlier log envelope httpswwwpivotaltrackercomstoryshowcomments decided increase walkdelay second give log cache time settle multiple log cache node foundation note issue filed log cache client increase default walk delay httpsgithubcomcloudfoundrygologcacheissues log recent behavior decided implement log recent single request log cache instead multiple pas walk implementation better performance mean walkdelay latest log returned request may settled three considered address nothing simply return log currently log cache render log two second old wait two second showing log point command started decided would likely break cat automated tooling run log recent command due lag log appearing poor made command two second slower would also missing log emitted command started see comment information consequence becomes easier difficult risk introduced change mitigated peeking latest log peeking latest envelope application remove dependency client clock making tolerant situation client clock closely synchronised server component generates log responsible assigning timestamp still potential clock drift within foundation cause unexpected behavior code slightly involved seems like good tradeoff delaying output new log momentarily delaying output new log envelope user advantage delaying able output consistent view log walkdelay implemented within log cache client comparison log envelope timestamps client clock therefore vulnerable misconfiguration client clock weve considered strategy removing dependency client clock decided wait feedback user attempting make reliable situation issue filed log cache client httpsgithubcomcloudfoundrygologcacheissues log recent behavior recent log returned command may settled may discrepancy output two consecutive run command