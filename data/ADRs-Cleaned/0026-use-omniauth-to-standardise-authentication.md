omniauth standardise authentication superceded devise rotp manage authentication otp application way authenticate user third party service auth see adr authentication third party provider well understood problem make sense leverage existing gem handle omniauth gem standardise authentication third party provider also support changing provider deemed necessary consequence omniauth gem well known cve open cve attack vector exploit well understood applicable certain condition mitigate risk following guidance gem author omniauthrailscsrfprotection gem prevent get request auth route add csrf protection post request link auth route post request taken step ignored warning cve security warning service run againsts repository httpsgithubcomukgovernmentbeisbeisreportofficialdevelopmentassistanceblobdevelopdocarchitecturedecisionsuseauthforauthenticationmd httpscvemitreorgcgibincvenamecginamecve httpsgithubcomomniauthomniauthwikiresolvingcve httpsgithubcomcookpadomniauthrailscsrfprotection httpsgithubcomukgovernmentbeisbeisreportofficialdevelopmentassistancesecurity