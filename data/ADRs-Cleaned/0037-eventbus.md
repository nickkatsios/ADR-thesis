event bus lazy consensus implemented many feature rely behavior triggered interaction mailbox api main interface rightmanager mailboxmanager messagemanager messageidmanager provide convenient extension mechanism organizing execution behaviour provide retries advanced error handling also protocol enable notification upon mailbox modification instance case rfc imap idle leveraged rfc imap unsolicitated notification selecting mailbox well maintaining imap message sequence number unique identifier msn uid mapping change happening specific entity mailbox propagated relevant listener james mailbox component core component james handling storage mail mailbox event driven architecture mean every meaningful action mailbox message trigger event component react event mailboxlistener allows executing action upon mailbox event could wide variety purpose like enriching mailbox manager feature enabling user notification upon mailbox operation performed device via protocol session interaction happen via manager rightmanager mailboxmanager messagemanager messageidmanager emit event eventbus ensure relevant mailboxlisteners executed least mailboxlistener registered work queue fashion eventbus work queue corresponds given mailboxlistener class configuration identified group event executed least within james cluster error retried exponential backoff delay execution keep failing event stored deadletter later reprocessing triggered via webadmin guice product enable registration additional mailbox listener user furthermore define mailboxlisteners via extensionjars mailboxlistener also registered executed event concerning specific entity mailbox registrationkey identifying entity concerned event upon event emission manager indicate registrationkey event sent mailboxlistener thus receive event registration key registered least fashion consequence provide implementation eventbus single server deployment also provide distributed event bus implementation current usage following feature implemented group mailbox listener email indexing lucene elasticsearch deletion mailbox annotation cassandra message metadata cleanup upon deletion quota update quota indexing quota mailing spamassassin spamham reporting reference jira