antivirus strategy change updated original plan upload file signed url checking file header determine whether fact text file research revealed fool proof way malicious user would able spoof virus text file instead signed url sending file directly instead send file backend scan clam sending event virus destroy file backend immediately return error frontend clamav rest server implementation able scan file virus malicious behavior additionally antivirus definition kept automatically included freshclam tool automatically downloads update internal database virus signature official clamav source addition frontend able reliably determine file binary file client check submitted file immediately return error user file sent backend consequence benefit network request user timely user feedback tell user file rejected even get also remove async notification like email assurance file malicious clamav already purpose government project ato head start ttadp provides easier foundation future planned effort parsing file content compliance familiar approach risk introduces slight risk file getting saved error occurs api sends approach require heavier lift accomplish signed url strategy benefit new approach make worth effort note