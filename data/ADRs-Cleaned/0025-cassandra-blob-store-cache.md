cassandra blob store cache lazy consensus implemented supercedes add storage policy blobstore james expose simple blobstore api storing raw data however raw data often vary size access pattern example mailbox message header expected small frequently accessed mailbox message body expected size ranging small big unfrequently accessed deletedmessagevault message header expected small unfrequently accessed access pattern kind blob fit object storage characteristic good storing big blob induces high latency reading small blob observe latency around cassandra latency get operation slow instance imap fetch header listing jmap message implement write cache better read latency smaller object cache distributed order efficient given dont want introduce new technology implement cassandra cache implemented keyvalue table dedicated cache keyspace replication factor queried consistency level one leverage configurable ttl eviction policy cache populated upon writes missed read blob size configurable threashold timewindow compaction strategy failure read cache cache miss result read object storage consequence metadata query expected query object storage anymore performance test proved strategy highly effective expect comparable performance improvement compared uncached objectstorage blob store hybridblobstore removed add storage policy blobstore proposes cassandrablobstore mimic cache solution needed work decided add write blob object storage order get centralized source truth able instantly rollback hybrid blob store adoption see pull request proposal eviction policy also storage done main keyspace high replication factor quorum consistency level high cost noted cached entry small assume small enough fit single cassandra row optimized large blob handling blobparts cassandrablobstore