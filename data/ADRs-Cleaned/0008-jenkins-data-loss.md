azure iaa disk encryption data loss prevention proposal per cnp ensure data loss jenkins time requirement ensure data loss jenkins time separate data drive jenkins ensure data drive replication enabled ensure data drive backed ensure jenkins box rebuild mount drive data drive iaa encrypted manually enable recovery vault jenkins data loss currently terraform script create infrastructure creates additional volume jenkins data volume resolve point partially resolve point block device currently support locally redundant storage data replicated least place within data center originally intention azure file httpsazuremicrosoftcomengbservicesstoragefiles order nfs volume attached would ease migration jenkins paas offering however given current state technology azure file provide zoneredundant storage meet requirement point encryption order acheive requirement point custom kernel module required installed linux system take advantage azure linux agent waagent communicates underlying hypervisor done packer build base image along several required package part bootstrap process jenkins master script installed run check presence data disk configure required script found httpsrawgithubusercontentcomcontinomojmodulejenkinsmasterdatadiskdatadiskshtokenajylgqjsftkzecmeeprtuupralfkksaadmiwadd unfortunately due way decryption disk seems take place virtual cdrom mounted credential required decrypt disk never come back online rebooted summary bahaviour sent microsoft currently awating feedback backup creating recovery vault backup policy achieve requirement point terraform currently support operation natively azure resource manager template create vault based azurequickstarttemplates work successfully however creation recovery vault policy fails create cli via console looking current api specification vault policy seems like much old functionality regressed summary bahaviour sent microsoft currently awating feedback consequence result issue listed current solution support given data stored triplicate encryption backup made microsoft come back fix andor workarounds reference linux kernel module download httpswwwmicrosoftcomenusdownloaddetailsaspxidbefedeacceeafatrueebbbebabdcbbcdddtruefadbbafebffeetrue azure encryption service httpsdocsmicrosoftcomenusazuresecurityazuresecuritydiskencryption encrypting disk linux httpsdocsmicrosoftcomenusazurevirtualmachineslinuxencryptdisks creating vault httpsgithubcomazureazurequickstarttemplatestreemasterrecoveryservicesvaultcreate creating vault policy httpsgithubcomazureazurequickstarttemplatestreemasterrecoveryservicesdailybackuppolicycreate vault policy api definition httpsdocsmicrosoftcomenusazuretemplatesmicrosoftrecoveryservicesvaultsbackuppolicies