adr orchestration new service creation adminusers project working adding support user self registration business goal allow prospective service register govuk pay create sandbox account without needing intervention support team proposed signup flow approximately follows user request create new account entering email address phone number sent email invitation including hyperlink nonce click link confirm email address authenticate second authentication factor entering code sent theyve authenticated service creation begin service created adminusers post vapiservices gateway account created connector post vapiaccounts return gatewayaccountid user created adminusers post vapiusers service updated contain gateway account patch vapiservicesserviceexternalid aware reason call done particular order uncertainty around appropriate design implementing proposed orchestration selfservice selfservice call post httpadminusersvapiservices selfservice call post httpconnectorvapiaccounts selfservice call post httpadminusersvapiusers selfservice call patch httpadminusersvapiservicesserviceexternalid shown black diagram orchestration adminusers selfservice call adminusers create service user account adminusers call post httpconnectorvapiaccounts record gatewayaccountid adminusers internally creates user adminusers internally creates service recording gatewayaccountid shown green diagram new servicemanager orchestration service new microservice let call servicemanager selfservice call servicemanager create service user account servicemanager call post httpadminusersvapiservices servicemanager call post httpconnectorvapiaccounts servicemanager call post httpadminusersvapiusers servicemanager call patch httpadminusersvapiservicesserviceexternalid shown red diagram discussion several people favour feeling cleaner avoid growing much business logic selfservice several people prefer feeling follows principle delivering business value early possible preclude extracting microservice later arises another concern raised around rollback depending order call may left sandbox gateway account connector associated service user adminusers service user account adminusers associated gateway account two possibility dangling sandbox account seems harmless could made harmless avoiding creating user account gateway account properly created associated service general following principle idempotency simpler way ensure eventual consistency dangling service gateway account inaccessible user whilst little crufty likely cause error given agreed persue initially get feature shipped quickly possible code production future user identified information ass whether needed orchestration selfservice consequence accept risk possible dangling sandbox gateway account connector also accept risk possible dangling service record adminusers design internal api call idempotent would increase complexity aware risk selfservice growing complexity requirement arise require orchestration multiple microservices reassess complexity start become burdensome may also extract microservice allow operation exposed public api management api