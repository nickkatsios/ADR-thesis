least delivery ready pay order proposed ready pay order handled special care wed like guarantee least delivery order order payment processing businesscritical scenario selling meal whole point case guarantee order store payment processor pick order execution time important avoid double payment concurrency issue order ready pay state arrives theory processed one time lead doubled tripled charge user account delivery ready pay order performed messagequeue software message acknowledgment additionally expect order come unique client device time processing order processing existence order checked version number staleness validation case event version discarded processing service consequence slightly decrease performance get data integrity usage eventstore projection order state help handle correct state change order