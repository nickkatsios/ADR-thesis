jwt library free jwt user generation metadatavalue author mhanel aricart approved tag client security problem statement user writing program issue user jwt ask done language assume program stamp set number identical user profile addition scoped signing key limit permission attached signing key instead user consequence user jwt generating program data model jwt library provides scoped signing key highly encouraged compromised key issue certain user user arbitrary permission thus simple utility function added nkey supporting client library replace jwt library case series standalone repository well single small utility function adding suitable client library seems easiest usage meet user similar nkey function language furthermore may needed every client library initially wed focus language widely corporate user jwt generating program expected would java csharp reference going much simplified version example instead jwt library full data model sprintf value library implementing require basic nkey function sign generate new nkeys sign exist every library supporting nkeys generating new nkeys matter baseurl random byte baseurl encoding decorating design proposed function supposed set value covered scoped signing key value name expiration account tag user nkey generated signer requestor provide signer unaware private nkey portion user generate nkeys provided functionality generate user nkey public well proposed name function signature signingkey mandatory account nkey pair sign generated jwt accountid mandatory public account nkey return error set account nkey publicuserkey mandatory public user nkey return error set user nkey name optional human readable name absent default publicuserkey expiration optional recommended duration generated jwt expire set jwt expire tag optional list tag included jwt return error issue arose string resulting jwt issueuserjwtsigningkey nkey accountid string publicuserkey string name string expiration timeduration tag string error string static header json typjwtalgednkey commented body json output subsequently turned jwt treat commented value static expiration specified time unix second derived provided duration exp issue time unix second always set iat public nkey portion signingkey aacyicoaqmqehtrlvvfwmivwfkwfepjjtteodjtuhmm unique implementation dependent value jwt library base encoded sha hash json jti jti frqcltpailkhkpppjsyohtanknhtpltxstgptgyzvgtohlq name provided value publicuserkey name username nats value accountid issueraccount adeccnbuebwzombfsnomkfpyrmtjstfqwysnpojbnku tag omit fully provided tag providedtag providedtag type user version public nkey portion signingkey sub udcvdaeygwvpybcliwjnwgjedmmwipgruevphrz jti random value possibly compute way jwt library body first generated jti set jti value computed base encoded sha hash body body generated time correct jti static header json well body baseurl encoded please note baseurl slightly different base padding character removed changed changed compute signature signingkey following string dot included per jwt specification baseurlheader baseurlbody encode signature baseurl concatenate return resulting token baseurlheader baseurlbody baseurlsignature consequence remove jwt library programmatically generating user jwt scoped signing key scoped signing key setup development command generate account named acc generate add signing key promote generated signing key scoped one arbitrary role name easier referencing issue next command bash nsc add account acc nsc edit account name acc generate nsc edit signingkey account acc role anyrolename add user value similar earlier json body sign scoped signing key output json execute bash nsc add user account acc name username tag providedtag tag providedtag expiry privatekey anyrolename nsc describe user account acc name username json invocation utility function generating similar user would look like issueuserjwtaccsigningkey adeccnbuebwzombfsnomkfpyrmtjstfqwysnpojbnku udcvdaeygwvpybcliwjnwgjedmmwipgruevphrz username timehour stringprovidedtag providedtag