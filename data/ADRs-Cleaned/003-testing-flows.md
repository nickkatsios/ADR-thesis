adr testing flow individual smart answer defined flow class defines question outcome associated logic journey user take smart answer currently different approach testing flow none applied consistently across adr concern definition approach consolidate inconsistency existing approach flow integration test test widely adopted flow test insufficient full testing mechanism nearly test still pas despite corresponding erb file problem syntax error missing file caught two style test involve heavy nesting though new introduced approach remove nesting flow unit test test intended complement flow integration test individual test flow erb file moderate adoption flow flow test flow view test duplicate assertion flow unit test flow integration test rspec feature test test low adoption flow test built upon rspec test framework removed smart answer exercise full integration including erb file exercising asserting via html output significantly slower test approach testing rail request approximately slower decided adopt new testing approach supersede aforementioned approach testing smart answer flow goal new approach provide test fast run assertion made erb level prove execution method achieve full least high coverage flow file easy understand test relatively given hard smart answer understand relatively low level tediumrepetition readingwriting test ideally length test flow file within flow file length testing approach consistent across different flow approach uri path query string session following two round feedback weve established new approach consolidate integration unit testing single approach similar rail controller testing similar emphasis integration testing since high possibility tedious level duplication multiple file boundary testing flow content explicitly testing earlier consideration routing controller due tested separately performance advantage gained including assert directly erb output unless logic erb file instead asserting output something prove syntax error reduce test verbosity friction copy change test flow style organised around node question outcome understandability code tested start page tested assert title body question test subsequent node reachable validation may test calculator complex scenario simple scenario would already tested implicitly however emphasis testing user visible scenario outcome tested explicitly specific logic already tested implicitly question reaching outcome approach offer number advantage existing testing approach also arrive concern noted prosterity concern setting node testing requires potentially large number previous response set may verbose repetitive contrived setup unit flow test rejected representative user journey bespoke assertion intended assist brevity due high level repetition flow test may come expense understandability relatively high level duplication written block asserted shoulda approach explored rejected due challenge reproducing failure coverage tool simplecov provide coverage data erb file mean cant monitor degree coverage file doesnt seem well maintained coverage tool offer ruby consequence new test written smart answer flow test written minitest stored new directory testflows chosen reflect test strictly unit integration test pair test location existing flow file including erb template moved location libsmartanswerflows new location appflows better suit main business logic application reflect view isnt library code app location conventional place erb file reside existing test testintegrationsmartanswerflows testunitsmartanswerflows specfeaturesflows removed gradually introduction new test testflows test removed directory deleted contribute towards removal rspec prior introduction new test existing minitest flow test amended ensure arent namespace collision new test example flowtesthelper likely collide well test name landlordimmigrationcheckflowtest finally testing documentation amended reflect new approach appendix syntax example set start page ruby class exampleflowtest activesupporttestcase include experimentalflowtesthelper setup testingflow smartanswerexampleflow render start page assertrenderedstartpage end end asserting question next node ruby question receivingnonexemptionbenefits setup testingnode receivingnonexemptionbenefits addresponses receivehousingbenefit yes workingtaxcredit receivingexemptionbenefits end render question assertrenderedquestion end nextnode next node housingbenefitamount empty response assertnextnode housingbenefitamount forresponse end next node based response assertnextnode bereavementamount forresponse wbereavement childbenefit end end end testing validation ruby question shiftworkerhourspershift setup testingnode shiftworkerhourspershift addresponses basisofcalculation shiftworker shiftworkerbasis fullyear end render question assertrenderedquestion end validation invalid hour assertinvalidresponse end invalid hour assertinvalidresponse end end nextnode next node shiftworkershiftspershiftpattern assertnextnode shiftworkershiftspershiftpattern forresponse end end end testing logic outcome ruby outcome result setup testingnode result render feeling unsafe help appropriate response given addresponses needhelpwith wfeelingunsafe feelunsafe yes nation england assertrenderedoutcome text feel unsafe live youre worried someone else end end