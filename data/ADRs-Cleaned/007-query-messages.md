adr query message otrv semantics otr query message alice requesting bob start otr conversation course willing able query message sent time protocol execution guarantee answered client support compatible otr version simply ignore always answered compatible client initiate new ake otrv query message start otr session participant willing otrv query message cause start ake finished participant key transition msgstateplaintext msgstateencrypted force key rotation forward secrecy depends advertisingacknowledging new key key reused message peer received heartbeat intended address issue new ake behaves exactly like normal key rotation loss message provide client mobility alice otr conversation bob order continue conversation another client login another client send new query message choosing start otr conversation instance tag another essential part propose query message otrv format otrv slightly difference semantics force key rotation case made unnecessary virtue otrvs double ratchet algorithm query message sent time except participant already encryptedmessages state allowing query message sent encryptedmessages cause new dake started conversation already exists case message previous conversation arrive new dake start may decrypted since participant replaces key material engage new dake client one version otr protocol allowed send several query message one different protocol version alice wish communicate bob would like otr sends message containing string otrv followed indication version otr willing bob version willing whether set global level percorrespondent basis implementer however enabling user choose whether want allow disallow version required otr client set different policy different correspondent furthermore user one client active time client could answer query message multiple time prevent query message force key rotation otrv disallowing sending encryptedmessages state prevent receiving query message state would also prevent client mobility query message set running version protocol started query message example contains byte identifier instance otrv started byte identifier contains one version version highest version chosen instance otr version begin conversation already started protocol version new query message different protocol version arrives encryptedmessages state conversation set new version previous message sent prior arrival new query message undecryptable example multiple query message sent alice want talk bob client respectively support version otr protocol alice start conversation sends query message version protocol bob accepts query message conversation start version alices client bug conversation stop side without sending tlv type disconnected stay conversation open another client support version protocol sends new query message advertises version bob receives message change protocol running version client bob message sent prior change running version lost undecryptable consequence participant still able receive query message encryptedmessages dishonest participant receiver start new dake message previous conversation start new ratchet fail verified decrypted receiver private key new dake message received able decrypted due change protocol version conversation started identity message otrvinteractiveonly otrvstandalone mode able handle plaintext message therefore unable change running version new query message always protocol version able receive message noninteractive dake even previously version