jetstream encryption rest metadatavalue author derekcollison implemented tag jetstream problem statement present way natsserver provide encryption rest stored jetstream data seen alternative encrypted filesystem block storage would provided cloud provider end user documentation feature found official documentation design design allow master key generate key asset encryption within jetstream asset account information metadata data stream consumer even within stream data broken multiple message block disk block different asset key encrypt key external key provided natsserver configuration via encryption service subsequent release kek encryption key derived always generated never stored generated via prf kek prfek hmacsha argonid aek asset encryption key encrypted via kek placed alongside asset disk encryption encryption utilize authenticated encryption aead chachapoly future support followon release may choose configure natsservers access direct access today recommended method environment variable demonstrated documentation key rolling initial release different key message block stream meaning kek aek reused subsequent message block however may want introduce ability roll key could tbd first release backup restore equivalent changing encryption key encrypt stream asset would want think rotating well point would access old one retrieving older asset client side could also consider allowing client provide header even server client could control course requires normally promote good provided solution like encrypted etc