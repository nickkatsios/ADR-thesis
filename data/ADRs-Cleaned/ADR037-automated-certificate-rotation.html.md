title adr automated certificate rotation adr automated certificate rotation certificate rotation largely manual process involving operator triggering series concourse pipeline job particular sequence routine rotation would typically part upgrade mean knowing cert rotation necessary checkcertificates job createcloudfoundry concourse pipeline would fail certificate day expired augustseptember moved platform secret aws credhub covered thirdparty service credential platform password certificate since credhub support certificate rotation chose implement automatic certificate rotation adr contains detail credhub notion transitional certificate written documentation transitional certificate new version signing yet added server trusted certificate list certificate rotation process built around setting migration transitional flag number deployment active certificate retired new certificate deployed without downtime order make certificate rotation automatic require operator interaction implemented job tail end createcloudfoundry pipeline acceptance test release tagging new rotatecerts job three task removetransitionalflagforca movetransitionalflagforca settransitionalflagforca three task reverse order process rotating certificate task ordered normally first task would set state second second would set state third bosh would unable deploy certificate without downtime however task explained proper order make easier understand certificate rotated understand happens pipeline assume bosh deploy happens step settransitionalflagforca first step process iterates certificate credhub looking expiring day regenerated transitional certificate result credhub holding two certificate credential name expiring certificate new certificate transitional flag movetransitionalflagforca second step process two job find certificate credhub value oldest certificate transitional flag newer one swap transitional flag older certificate finally look leaf certificate signed certificate regenerates new certificate look leaf certificate expiring day regenerates one step process deployed next bosh deploy removetransitionalflagforca third final step process iterates certificate credhub looking value older certificate marked transitional newer certificate remove transitional flag older certificate effect dropping certificate existing checkcertificates job also modified check certificate expiring day certificate fails check suggest something gone wrong certificate rotation process consequence certificate rotation happen frequently well update documentation surrounding certificate rotation documentation reference