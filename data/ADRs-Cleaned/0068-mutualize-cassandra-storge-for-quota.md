mutualize cassandra storage quota lazy consensus implemented one generic threat resource abuse meaning user unfair amount resource similarily resource limitation way decrease operating cost quota standardized imap via rfc jmap via rfc mechanism designed keep track user current usage resource match stored limit resource limitation broad case might want better enforce apache james especially important operating saas mode actual user might badly intentionned see adr quota jmap uploads duplication especially storage layer similar feature might benefit mutualized storage especially worth mentionning cassandra table come free strong incentive reduce count see last pickle blog post topic particular quote article table share column could interesting merge single one adding column partition key distinguish data belonging different table add cassandra storage helper exposing generic interface cassandra quota implementation various service mutualize storage relies part primary key allowing distinguish component helper consist table one composed counter track current value one composed regular long track limit one mix counter regular value table cassandra port exising cassandra implementation quota various service helper namely cassandra mailbox sieve storage helper implement jmap quota uploads consequence expect small decrease count table cassandra schema going one mailbox quota current value one mailbox quota per user limit one mailbox quota per domain limit one mailbox quota global limit one sieve uota current value one sieve quota per user limit one sieve quota global limit one jmap uploads current value helper table one current value one limit expect make easier implement quota related feature future set cassandra migration task record schema upgrade upgrade instruction compaibility mode explicitly configured order run migration keep current exploded table structure either care table count increase implement important resource limitation case reference jira adr last pickle article impact many table cassandra daa model rfc imap quota rfc jmap quota adr quota jmap uploads