replace kbparallels another solution avoid deadlock related adr note adr place keep current discussion httpsdocsgooglecomdocumentdawjaymoqcogkpotjxxevoyynftcecbdnevturo rather make still planning scoping testing involved fully design system still determined scope adr relates bulk execution xsv analysis relates bulk execution intro sometimes calculation requires many resource one node walltime memory disk calculation get spread across multiple machine final step app kbparallels create report step may result computed job create final report order following apps mechanism called kbparallel kbbowtie refseqimporter kbconcoct kbphylogenomics kbhisat kbmetadecoder kbbwa current implementation batch analysis kbbatchapp kbase following issue current adequate user shouldnt code order run batch analysis also difficult even familiar kbase code find object name dependency kbparallel change kbparallel could affect batch subsequently apps queue deadlocking user max slot queue current implementation one management job created manage job submits could lead deadlock scenario management job waiting submit computation job cannot slot kbp spawn kbp job batch job spawn batch job missing ability able run manage cancel track job subjobs along ability specify resource differently main sub job good way test hard benchmark measure performance code split necessary doesnt properly display progress batch job author bioboris mrcreosote planning current idea documented outcome pending research iron detail first pas would likely limit number kbparallel run next pas would want create comprehensive generalized solution submitsplit aggregate recipe convenience common operation creating set report thing nature would also want user study want functionality want may inform design backend system deprecate kbp instead break apps part fan process parallel pip fan step user launch job normal possibly job marked job make easier display job correctly initially ideally would marked spec might lot work could potentially marked catalog along job requirement job figure pip sub job job sends following info job parameter sub job app job kbphylogenomicsbuildmicrobialspeciestreereduce start subjobs associate job probably retry handling subjobs deal transient error whenever subjob finish check see subjobs finished true start job providing output subjobs list reduce job job finished job done various job communicate storing temporary data caching service blobstore latter job clean blobstore node complete could make helper app workflow engine wdl cromwell reinventing wheel new endpoint speed reduce complexity step note dag endpoint dag would least first job followed subdag external somewhere first job youd generate new dag workflow defines cluster followed job run subdag dagman support python binding following two way htcondorsubmitfromdag take name dag filename submit resulting object like regular job htcondordags library programmatically construct dag workflow computer memory write dag file submit function mentioned several different way want there useful example show general workflow binding httpshtcondorreadthedocsioenlatestapispythonbindingstutorialsdagcreationandsubmissionhtmldescribingthedagusinghtcondordags consequence implement new narrative however work would happen regardless due looking improve batch upload analysis kbase take significant time research engineer solution still determined scope adr relates bulk execution xsv analysis relates bulk execution alternative considered ignore issue make apps run kbparallels limited instance kbparallels per user avoid deadlock remove kbparallels change apps collection apps submit split aggregate endpoint create dag different devops solution rewriting kbp swapping lightweight alternative subset kbp feature pro con alternative general note current implementation kbp separate kbp queue multiple machine save spot user job maximum running job take waste compute resource especially node sit idle user still get job spot job run overall system make another queue requires taking compute node currently dedicated queue without changing apps kbp running multiple kbp apps machine interfere want avoid scrap kbp favor lightweight alternative avoid previous issue modify apps kbp lightweight alternative lightweight alternative would guarantee computation besides job management occured could management job sit wait job without interfering job system increase number slot per user simple solution quick turnaround fix deadlock issue small number job doesnt fix deadlock issue user still submit kbp job address deadlocking issue still broken regular run batch run small amount user take entire system able submit job node continue taken job little computation job get node capacity still wasted kbp job sit around waiting job run limit kbp job maximum active kbp job per user simple solution requires maintain list kbp apps add kbplimit job list condor kbplimit added list apps frequently updated apps modified new app kbp app list wont limited kbplimit unless owner let know existing app longer kbp app still limited unless owner let know node continue taken job little computation job get node user may able effectively job spot capacity still wasted kbp job sit around waiting job run limit kbp job maximum active job per user seperate queue kbparallels apps pro user able effectively job spot allows group kbp job onto fewer machine instead giving entire node requires going app understanding worst case computational order set estimated cpu memory app apps interfere innocent apps take creating new queue requires balancing many active kbp node many node available job capacity still wasted kbp job sit around waiting job run build kbp lightweight version kbp queue design new verison apps must modified new kbp lightweight version either modify kbp create new toolpackage instead kbp launch management job called job manager sits kbp queue alongside kbp job job launched queue launch setup job user parameter andor optionally download data user parameter figure job manager parameter result information gathered initial download user parameter generate final parameter sent job manager launch fan job directly launch fan job return job job manager enough parameter launch andor monitor fan job monitormanage job possibly retry upon failure fan job download data perform calculation save back system return reference saved object job manager launch one fanin job based user parameter result fan job fanin aka groupreducereport job downloads object system creates set grouping save object back system final data report uploaded back system job manager return reference result report job proscons kbp job run small subset machine deadlock issue fixed change required address deadlocking issue still broken regular run batch run reuse kbp needed basis would rewrite apps kbp new paradigm modify apps local submission remove kbp moving job simple solution quick turnaround fix deadlock issue fix issue limited number larger resource machine continued dependency deprecated kbp tool app run may take longer since fewer resource may available app run