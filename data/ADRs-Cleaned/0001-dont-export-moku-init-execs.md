dont export moku init exec let say ten application app app app defined hiera deploy host read furthermore let say named instance four different production host like deploy host app host app host app host app host app app app app app app app app apps actually instantiated couple one host setup deploy host run moku init four apps apps havent yet instantiated deploy host run command app know set itll run init per app itll run apps want app host export exec resource example deploy host would find command app app app app wouldnt find apps itd find many apps deploy host run puppetdb query find named instance get list unique instance name get list apps could run moku init desired behavior experience puppetdb query negative hard test ugly hard read addition moku init command requires json file exist deploy host application based hieradata among thing json file contains hash keyed datacenter list application host unacceptable deploy host run moku init incomplete list application host run moku init hand puppet manage configuration json also init command accept application host keyed hostname instead datacenter instead yaml deploy site hatcher node node macc node node well yaml deploy site node node hatcher node hatcher node macc node macc way dont supply separate order number datacenter try come way anything clever way concat fragment handle json named instance simply export line hostname datacenter done consequence well run moku init hand subsequent configuration done hand anyway still helpful puppet set json truthful information host ready serve application