title mocking repository area core tag testing core repository right complicated test class dependency repository mocking repository search searchids call requires creating empty entitysearchresults idsearchresults lead much boilerplate code writing test faking database result reason provide way mock search searchids call much easier way faking search result repository look like moment php result new entitysearchresult myentity new entitycollection null new criterion contextcreatedefaultcontext entityrepository thiscreatemockentityrepositoryclass entityrepository expectsstaticonce methodsearch willreturnresult solution created shopwaretestsunitcommonstubsdataabstractionlayerstaticentityrepository allows developer easily fake repository search result php class somecoreclass public function constructprivate entityrepository repository public function foo criterion new criterion result thisrepositorysearchcriteria class somecoreclasstest extends testcase public function testfoo repository new staticentityrepository new unitcollection new unitentity new unitentity class new somecoreclassrepository classfoo assertion staticentityrepository constructor accepts array entitysearchresults entitycollections aggregationresultcollection value result search one supported collection configuration php class somecoreclasstest extends testcase public function testfoo repository new staticentityrepository new unitcollection new unitentity new aggregationresultcollection new avgresultsomeaggregation new entitysearchresult entity new entitycollection new aggregationresultcollection new criterion contextcreatedefaultcontext uuidrandomhex uuidrandomhex uuidrandomhex new idsearchresult new criterion contextcreatedefaultcontext class new somecoreclassrepository classfoo assertion