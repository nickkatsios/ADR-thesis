restricting user access object superseded proxy uploads cloudfront ensure tdr user able overwriteview another user object tdr aws upload bucket potential resolve problem aws cognito signed url decided aws cognito keycloak openid authentication provider iam policy restrict access user object aws cognito advantage signed url signed url mean eavesdropper potentially grab signed url expires note aws signed url http eavesdropper public network cannot see secret part request parameter path aws cognito work aws encrypted aws set aws iam key policy allowing access aws key aws cognito identity separate signed url would generated file would mean generating thousand url large consignment detail aws congito would work given section aws cognito keycloak restrict access aws bucket object aws iam policy restrict access aws bucket object following aws iam policy example aws cognito identity sub parameter control access aws bucket object note cognitoidentityamazonawscomsub refers identity associated user aws cognito identity pool version statement sid writeyourobjects effect allow action sputobject resource arnawssbucketnamecognitoidentityamazonawscomsub policy restricts listing aws object contain prefix including identity user see following detail httpsdocsawsamazoncomiamlatestuserguidereferencepoliciesexamplesscognitobuckethtml aws iam policy tdr tdr keycloak manage authenticate user able make iam policy outlined control access aws object keycloak integrated aws cognito identity provider keycloak user associated aws cognito identity aws iam policy keycloak made aws cognito authentication provider two way custom developer authentication provider openid authentication provider detail set aws cognito identity pool two approach available custom developer authentication provider httpsdocsawsamazoncomcognitolatestdeveloperguidedeveloperauthenticatedidentitieshtml openid authentication provider httpsdocsawsamazoncomcognitolatestdeveloperguideopenidhtml additional detail authentication flow approach available httpsdocsawsamazoncomcognitolatestdeveloperguideauthenticationflowhtml spike example method custom method quicker set initially help prove iam policy would restrict access user aws object production openid method standard based practical example outline step create aws bucket set keycloak openid authentication provider aws iam set aws cognito identity pool keycloak authentication provider create iam policy restricting access object prefixed aws cognito identity associate iam policy authenticated iam role associated aws cognito identity pool aws setup sandbox account aws sandbox account two aws cognito identity pool created keycloak custom openid authentication provider custom tktest openid tktestoidc aws iam policy created restrict access object aws bucket based user associated identity respective aws cognito identity pool tktestslimitaccesscognito policy attached iam role associated identity pool authenticated identity enable aws iam policy work following object prefix structure implemented cognito identity valuesub prefix following tdr transfer frontend branch two function seriesdetailscontrollerscala demonstrate restricted access practice httpsgithubcomnationalarchivestdrtransferfrontendtreecognitodeveloperauthprovider function add object bucket list object prefix matching aws cognito identity value run branch following environment variable set authurlauth url intg environment sandboxaccountnumberaws sandbox account number testbucketnamename bucket apiurlapi url intg environment devprovidedidentitypooliddev provided identity pool oidcidentitypoolidoidc cognito identity pool oidcprovidedloginskeyoidc provider logins key devprovidedloginskeydev provider logins key authsecretintg env auth secret note aws iam user created provide access aws cognito client setting keycloak openid authentication provider aws cognito order set keycloak openid authentication provider following obtain root thumbprint keycloak see following guide httpsdocsawsamazoncomiamlatestuserguideidrolesproviderscreateoidcverifythumbprinthtml set keycloak oidc identity provider aws cognito aws cli currently bug aws console see following guide httpsdocsawsamazoncomiamlatestuserguideidrolesproviderscreateoidchtmlmanageoidcprovidercli note providing url argument createopenidconnectprovider aws cli command form keycloak urlauthrealmstdr useful document httpsawsamazoncomblogssecuritywritingiampoliciesgrantaccesstouserspecificfoldersinanamazonsbucket depth look iam policy restrict access bucket object concentrate aws console access still relevant