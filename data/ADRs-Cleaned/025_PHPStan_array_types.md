type array phpstan annotation deciders abban dunne corinna hillebrand gabriel birke tanuja array pervasive data structure php php differentiate list tuple hashmap data type array many library part code also hashmaps defined key instead object php lack one feature strict typing array key value phpstan allows make phps deficiency static analysis code phpstan allows higher check level even requires create phpdoc annotation specify array shape phpstan also allows give array shape name phpstantype annotation feature similar type alias typescript custom type following benefit help structure complex nested array shape manageable chunk make code easier read reader parse different bracket type maybe even nested shape different bracket arrayemailaddressarraystringmixed represents list tuples containing email address hash map custom type give array meaningful name argument custom type follows toolspecific native language switch tool language get new feature change annotation current ides support syntax support good support native language feature reviewing code unclear come defined php package violating one class per file rule php autoloading convention phpstan configuration confused class name without rigorous naming convention type definition annotation look like class contradicting native php type array creates layer indirection youd train looking statement see name come also phpstanimporttype statement andor phpstan configuration file wont custom type definition array code treat nested hardto read structure code smell trying find better objectoriented structure possible class value object instead array consequence four type array list map tuples object shape well try apply following guideline concerning usage conversion type list code iterates array without random access like would map liststyle annotation type content array array function foreach loop good indicator code array list example emailaddress donation string map best indication map type string key random access specific integer key exactly one value type sometimes exactly one value type criterion deceiving see code set specific string value array question likely pseudoobject object shape see example param arrayintstring statuscodetomessage return arraystringroutefunction return arraystringbool moderation reason flag active tuples fixedlength array specific type mostly return type function return one result item tuples helpful especially destructuring syntax list tuples nest class sign refactor tuple value object example code good tuple usage php function sendmail recipient body thisprepareemail code return arrayemailaddressemailbody function prepareemail get value somewhere return recipient body example annotation smelly tuple usage var arrayemailaddressemailbody preparedemails var arrayarrayemailaddressemailbodyemailaddressemailheaders fullemail objectlike array complex shape data structure come earlier php version allow easy definition value object php missing named parameter readonly property typed property agree turn array value object ideally readonly constructor property change code array help give proper name concept thats hiding inside array definition example arrayfirstnamestringlastnamestringageint becomes class person public function construct public readonly string firstname public readonly string lastname public readonly int