lightweight transaction cassandra code base lazy consensus scope distributed james implemented kind server james provide level consistency strong consistency achieved cassandra relying lightweight transaction enables optimistic transaction single partition key hood cassandra relies paxos algorithm achieve consensus across replica allowing achieve linearizable consistency entry level cassandra track consensus systempaxos table systempaxos table checked upon read well order ensure latest state ongoing consensus known achieved serial consistency level experiment distributed james cluster james node cpu ram node cassandra cluster ram cpu ssd disk demonstrated systempaxos table far read compacted table ratio table triggering read systempaxos table acl table deactivating lwt table alone lightweight transaction serial consistency level enabled instant throughput latency reduction well softer degradation load breaking point exceeded rely event sourcing maintain projection acls rely lwt serial consistency level event sourcing thus responsible handling concurrency race condition well governing denormalization acls source truth rebuild acl projection note acl projection table end synchronization aggregate still nonquestionable source truth handled via event sourcing consequence expect better load handling better response time cheaper operation cost distributed james compromising data safety acl operation acl update rare operation expect significant degradation write performance relying eventsourcing implement corrective task fix acl denormalization projection applicative read repair could implemented well offering diagnostic onthefly correction without admin action low probability however loading event sourcing aggregate cheap thing complementary work several place rely lightweight transaction cassandra code base might want challenge trigger mailing list discussion issue related adrs user rely lwt throwing alreadyexist exception lwt likely unnecessary webadmin presentation layer offering idempotent api silents alreadyexist exception cli soon deprecated guice product make distinction discussion started topic proof concept available domain rely lwt throwing alreadyexist exception lwt likely unnecessary webadmin presentation layer offering idempotent api silents alreadyexist exception cli soon deprecated guice product make distinction discussion started topic proof concept available mailbox relies lwt enforce name unicity hit pitfall acls often read table however mailbox given user grouped together primary key read limited hence critical similar result could expected discussion topic started yet impact study performance conducted message flag update far transactional however better relying table structure store flag could relying cassandra solve data race issue note also imap condstore extension implemented might nonviable performancewise might choose favor performance transactionality topic discussion topic started yet lwt required eventsourcing event sourcing usage limited lowusage case performance degradation issue note eventsourcing could maintain lwt free projection infrequent writes lwt mentioned thus avoiding performance issue keeping consistent source truth see acl lwt usage required generate uids append message operation tend limited compared message update operation likely critical uid generation could handled via alternative system past implementation conducted zookeeper implementing imap condstore generation imap modseq likely longer make sense fate modseq linked message topic technology monotic integer generation could investigated like atomixio zookeeper similarly lwt try keep count email mailrepository synchronize usage nonperformance critical mda mail delivery agent case might bigger impact mta mail transfer agent discussion work started topic usage lwt include sieve script management initialization rabbitmqmailqueue browse start lowimpact case reference original pull request exploring topic james cassandra longer rely lwt domain user jira ticket pull request abandoning lwt read mailbox acl adr applicative read repair adr acl inconsistency buggy imap condstore link mailing list thread discussing adr pull request adr might include useful information well