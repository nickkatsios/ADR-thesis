adr process rabbitmq message sidekiq job content performance manager subscribed event publishingapi via rabbitmq moment process event synchronously class consumer def processrabbitmqmessage preprocess doprocessrabbitmqmessage postprocess end end item run within transaction effectively wrap activerecordbasetransaction doprocessrabbitmqmessage end configuration unexpected side effect database seems reject connection via following message pgconnectionbad pqsocket cant get socket descriptor begin debugged database many hour got feeling connection might shared among multiple thread happens staging rabbitmq worker host case already planned sidekiq processing message allows reuse existing monitoring capability govuk support outofthebox exponential backoff algorithm retries process event publishing api sidekiq job consequence define new activejob job process message