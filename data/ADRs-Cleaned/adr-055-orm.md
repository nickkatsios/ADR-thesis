adr orm changelog first draft implemented abstract order make easier developer build cosmos sdk module client query index verify proof state data implemented orm objectrelational mapping layer cosmos sdk historically module cosmos sdk always keyvalue store directly created various handwritten function managing key format well constructing secondary index consumes significant amount time building module errorprone key format nonstandard sometimes poorly documented subject change hard client generically index query verify merkle proof state data known first instance orm cosmos ecosystem weave later version built regenledger group module later ported sdk purpose earlier design made significantly easier write state machine still required lot manual configuration didnt expose state format directly client limited support different type index key composite key range query discussion design continued httpsgithubcomcosmoscosmossdkdiscussions sophisticated proof concept created httpsgithubcomallinbitscosmossdkpoctreemasterruntimeorm httpsgithubcomcosmoscosmossdkpull prior effort culminated creation cosmos sdk orm module protobuf annotation specifying orm table definition orm based new googlegolangorgprotobufreflectprotoreflect api support sorted index simple protobuf type except byte enum float double well timestamp duration unsorted byte enum index composite primary secondary key unique index autoincrementing uint primary key complex prefix range query paginated query complete logical decoding kvstore data almost information needed decode state directly specified proto file table definition specifies unique per proto file index within table unique within table client know name module prefix orm data specific proto file within module order decode state data directly additional information exposed directly app configs explained future adr related app wiring orm make optimization around storage space repeating value primary key key value storing primary key record example object primary key stored key value store key value efficient protobuf binary encoding also generated code httpsgithubcomcosmoscosmosproto optimization around googlegolangorgprotobufreflectprotoreflect api improve performance code generator included orm creates type safe wrapper around orms dynamic table implementation recommended way module orm orm test provide simplified bank module demonstration illustrates orm proto generated code example usage module keeper consequence backwards compatibility state machine code adopts orm migration state layout generally backwards incompatible state machine also migrate httpsgithubcomcosmoscosmosproto least state data positive easier build module easier add secondary index state possible write generic indexer orm state easier write client state proof possible automatically write query layer rather needing manually implement grpc query negative worse performance handwritten key see discussion potential improvement neutral discussion discussion happen within cosmos sdk framework working group current planned ongoing work includes automatically generate clientfacing query layer clientside query library transparently verify light client proof index orm data sql database improve performance optimizing existing reflection based code avoid unnecessary get deletes update simple table sophisticated code generation making fast path reflection even faster avoiding switch statement even fully generating code equal handwritten performance reference httpsgithubcomiovoneweavetreemasterorm httpsgithubcomregennetworkregenledgertreefeaadedaorm httpsgithubcomcosmoscosmossdktreedcbefcbafcdxgroupinternalorm httpsgithubcomcosmoscosmossdkdiscussions httpsgithubcomallinbitscosmossdkpoctreemasterruntimeorm httpsgithubcomcosmoscosmossdkpull