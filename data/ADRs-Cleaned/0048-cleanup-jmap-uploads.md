cleanup jmap uploads lazy consensus implemented overridden quota jmap uploads jmap allows user upload binary content called blob later referenced via method call includes limited emailset specifying blobid attachment emailimport specification strongly encourages enforcing cleanup uploads blob referenced jmap object message attachment may deleted server free resource uploads see initially unreferenced blob unreferenced blob must deleted least hour time upload reuploaded blobid may returned reset expiry time deleting uploads timely manner important enables freeing server resource failing may compromise privacy content user uploaded long forgotten might still accessible underlying datastore failing delete uploads timely fashion may jeopardize instance gdpr compliance today uploads stored along side email attachment mean hardly apply specific lifecycle clean uploads distinguishing attachment uploads trivial currently complex right resolution system attachment handling upload case attachment linked user true attachment case linked message access message access attachment lead suboptimal code slow create separate interface uploadrepository datajmap store uploads user would provide memory implementation well distributed implementation distributed implementation would host metadata upload cassandra content blobstore api object storage uploadrepository would jmap rfc back uploads instead attachment manager provide blobresolver enable interaction uploaded blob similarly uploadrepository back uploads jmap draft implement cleanup distributed uploadrepository done via ttls cassandra metadata organisation blob time ranged bucket two recent bucket kept webadmin endpoint would allow plan cron triggering cleanup consequence upon migrating uploadrepository previous uploads carried migration plan provided impact minimal upload prior change never cleaned acceptable jmap implementation marked experimental clean attachment storage within mailboxapi implementation drop attachmentowners cassandra table remove getowners storeattachmentforowner method attachment mapper rename storeattachmentsformessage storeattachments attachment mapper simplify resolution logic storeattachmentmanager looking message ownership enough fusion attachmentmessageid attachmentv table attachmentmessageid dropped next release attachmentv altered add referencing messageid migration task provided populate meantime fallback strategy supplied messageid cell null default reading old attachmentmessageid table alternative jmap blob draft proposed client explicitly delete uploads blob create entity extension introduce mean delete blob however relying client enforce effective deletion seems brittle case client failure malicious client mechanism would ensure effective deletion main jmap specification mandate encourage client clean uploads blob extension interoperability issue would arise reference jira adr thread serverdev mailing list