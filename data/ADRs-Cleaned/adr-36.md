subject mapping transforms stream metadata value author jnmoyne implemented tag jetstream client server problem statement subject mapping transformation available core nats level meaning order define modify mapping one either access server config file access account key operator security mode core nats subject mapping place scaling single stream writes partitioning traffic routing canary testing many case subject mapping happen stream core nats serveraccount level define subject mapping quite limiting easy application programmer able define mapping heshe even access account key hand allowing application subject mapping transforms stream level make easy application developer nats administrator define manage mapping one place stream message flow subject mapping transforms applied enables interesting new functionality bucket sourcing prior work see adr core nats subject mapping description available subject transform function feature introduced new feature introduced version nats server allow application subject mapping transformation multiple place stream configuration apply subject mapping transformation part stream mirror apply subject mapping transformation part stream source amongst case enables ability sourcing bucket name bucket part subject name bucket stream therefore transformed sourcing name sourcing bucket different name bucket sourced apply subject mapping transformation ingres input stream meaning received core nats mirrored sourced another stream limit applied get persisted subject mapping transformation filter message transforms subject message matching subject mapping source enables ability insert partition number token message subject also apply subject mapping transformation part republishing message subject mapping transformation seen extension subject filtering subject mapping transformation without associated subject filter subject filtering mapping transform composed two part subject filter source part transform destination transform destination part transform empty destination transform mean transformation subject like stream consumer one single subject filter mirror source one set subject filter transform destination like consumer either specify single subject filter optional subject transform destination array subject transform configs composed source filter optionally empty transform destination addition possible source different stream also stream define single source multiple subject filter transforms case ordering message guaranteed preserved overlap filter define multiple source stream subject filter overlap source thereby making possible duplicate message sourced stream order message source guaranteed preserved example stream contains message subject foo bar baz want source foo bar stream could specify two subject transforms empty destination single source source twice stream foo subject filter second time bar subject filter stream config structure change user perspective feature manifest new field stream configuration request stream info response message mirror source additional subjecttransforms array source array mirror containing object made two string field src dest note subjecttransforms array also single string subject filter dest empty case transformation filtering top level stream config additional subjecttransform field stream config containing two string src dest bucket sourcing subject transforms stream open ability sourcing bucket client library implement automatically adding subject transform source configuration underlying stream bucket sourcing transform question map subject name sourced bucket name sourcings bucket name bucket source transform config source stream stream following transform subjecttransforms array streamsource src kva dest kvb example stream mirror sourcedstream stream two subject filter transform example foo transformed bar json name sourcingstream retention limit maxconsumers maxmsgspersubject maxmsgs maxbytes maxage maxmsgsize storage file discard old numreplicas duplicatewindow mirror name sourcedstream subjecttransforms src foo dest footransformed src bar dest sealed false denydelete false denypurge false allowrolluphdrs false allowdirect false mirrordirect false stream source sourcedstream stream twice time single subject filter transform json name sourcingstream retention limit maxconsumers maxmsgspersubject maxmsgs maxbytes maxage maxmsgsize storage file discard old numreplicas duplicatewindow source name sourcedstream subjecttransforms src foo dest footransformed name sourcedstream subjecttransforms src bar dest bartransformed sealed false denydelete false denypurge false allowrolluphdrs false allowdirect false mirrordirect false stream source stream subject transform json name foo retention limit maxconsumers maxmsgspersubject maxmsgs maxbytes maxage maxmsgsize storage file discard old numreplicas duplicatewindow source name source filtersubject streamfoo name source filtersubject streambar name source subjecttransforms src streamfoo dest foo src streambar dest bar subjecttransform src foo dest mappedfoo sealed false denydelete false denypurge false allowrolluphdrs false allowdirect false mirrordirect false client implementation jsmgo natsgo natscli