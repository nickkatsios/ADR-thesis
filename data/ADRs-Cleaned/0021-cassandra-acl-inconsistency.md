cassandra acl inconsistency proposed implemented yet mailbox acls denormalized cassandra order given mailbox list acl enforcing right example discover mailbox delegated given user list mailbox table organisation acl store acls given mailbox usermailboxacl store mailbox delegated user failure denormalization process lead inconsistency two table lead following user experience alice delegate inbox mailbox bob denormalisation process fails alice inbox appear bob mailbox list given delegated mailbox inboxdelegated alice undo sharing inboxdelegated mailbox denormalisation process fails alice inboxdelegated mailbox still appears bob mailbox list bob try select denied adopt retry policy usermailboxacl projection update mitigation strategy acl table source truth rebuild usermailboxacl projection iterating acl entry rewrite entry usermailboxacl iterating usermailboxacl remove entry referenced acl adding delay recheck actual fix decrease occurrence concurrency issue expose webadmin task consequence user action concurrent inconsistency fixing task could result concurrency issue new inconsistency could created however table truth would impacted hence rerunning inconsistency fixing task eventually fix issue task could run safely online scheduled recurring basis outside peak traffic admin ensure cassandra acl consistency reference plan fixing cassandra acl inconsistency general mailing list discussion inconsistency pull request james concurrency testing fixing cassandra mailbox inconsistency delay strategy decrease concurrency issue occurrence described