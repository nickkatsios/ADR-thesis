title adr rds broker restore last operation adr rds broker restore last operation completely stateless implementation rds broker described adr asynchronous operation rds instance relying executing unique operation aws api querying rds instance reported aws api implement feature restore snapshot must execute several operation sequentially broker must start restore snapshot take minute finish update several parameter instance security group parameter etc finish reset master password rds instance finally reset password user previously bind original create operation asynchronous operation cloud controller api periodically request lastoperation endpoint query state restored instance rdsbroker must respond accordingly cloud controller api includes logic ensure resiliance service creation maintaining worker poll lastoperation service created timeout implement kind logic kind state must kept track change instance run background housekeeping routine housekeeping resilient rdsbroker restarts able work multiple rdsbroker instance sqs subscribing aws event rds requires lot additional work integration effort store state database store decided implement state machine aws tag instance add list tag pending operation execute make lastoperation check pending operation perform finally delete corresponding tag mark done assume required operation either asynchronous aws api update instance quick execute reset bind user password update tag atomic synchronous consequence lastoperation endpoint actual logic update database