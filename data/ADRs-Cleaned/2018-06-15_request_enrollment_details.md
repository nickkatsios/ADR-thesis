sending initial host detail enrollment request author victor vrantchan groob june updated revisiting enrollment detail enrolling osquery remote server desirable also set initial field osquery node usually server like fleet queue adhoc query get information always reliable example osquery host succeed enroll method immediately crash leaving server operator little osquery host troubleshoot another effect populating host detail via distributed query add latency enrollment process depending query interval add enrollmentdetails structure requestenrollment method sends result population query part enrollment list chose attribute launcher always send message enrollmentdetails string osversion string osbuild string osplatform string hostname string hardwarevendor string hardwaremodel string hardwareserial string osqueryversion string launcherversion consequence enrolling host always send required data server identify host attempting enrollment make change reorder position osqueryextensionenroll method launcher extension initially enroll method called even osqueryd started order ensure osqueryd start valid nodekey fetch remote config osquerygo client run population query meant osqueryd must already running rearranging order component pose visible issue enroll method called immediately case latency osqueryd starting node key returned server osqueryd wil fail fetch config practice requestconfig method retried immediately enroll avoiding potential problem also expose setquerier method osquery extension order allow setting client querier allows querying osquery type querier interface querysql string mapstringstring error method implemented runtimerunner unfortunate consequence reenrollment apis signature enroll method must additional argument find different way set client extension someone instantiates osqueryextension know also call extensionsetquerierrunner order enrollmentdetails populated