adr plugins changelog init commit modular design celestianode allows functionality provides extended main blocker creating custom light client application mechanism access internals celestianode suggesting interface installs custom service celestianode along making celestianode cli portable light client developer create binary custom service create alternative approach export field celestianode object possible achieve flexibility custom node requires limit developer custom node user instance running custom node take two binary installed associated version creating custom node implement redundant functionality basic program structure cli test also make difficult custom node support different type celestia node plugin design possible run plugin every node type without adding code lastly approach wouldnt make easy run custom node multiple modification whereas plugin approach expose service rpc would likely require lot overhead eliminate existing complexity postponed per comment comment comment planning taking different approach focus exposing general purpose api provide custom functionality plugins provide cumbersome support future also serving however still possibility merge plugin implementation different design provides similar functionality future decide support custom node detailed design approach feature new plugin interface type plugin interface name string initializepath string error componentscfg config store store fxutiloption implementation plugin interface passed new function generate return provided plugins newrootcmd return initiated celestia root command provided plugins installed celestianode func newrootcmdplugs nodeplugin cobracommand plugins makestring lenplugs plug range plug pluginsi fmtsprintfwith plugin plugname commandaddcommand newbridgecommandplugs newlightcommandplugs versioncmd commandsethelpcommandcobracommand return command newbridgecommand creates new bridge sub command provided plugins installed celestianode func newbridgecommandplugs nodeplugin cobracommand command cobracommand bridge subcommand args cobranoargs short manage bridge node persistentprerune funccmd cobracommand args string error commandaddcommand init plug start plug return command starting initiating new celestia node plugins passed setting setting store non config value altered node type setting struct ppkey cryptoprivkey host pphostbase coreclient coreclient plugins plugin plugins added service creating celestia node withplugins add provided plugins setting func withpluginsplugins plugin return funcc config setting error splugins plugins return nil new assembles new node given type store store func newtp type store store node error cfg err storeconfig err nil return nil err newsettings range nil err optioncfg err nil return nil err switch case bridge return newnodebridgecomponentscfg store spluginscfg store soverrides case light return newnodelightcomponentscfg store spluginscfg store soverrides default panicnode unknown node type plugins also perform arbitrary initialization routine init initializes node filesystem store given node type directory path default config applied default config persisted disk func initpath string type error cfg set defaultconfigtp newsettings range nil err optioncfg set err nil return err plug range setsplugins err pluginitializepath err nil return err return nil user requirement plugin design work utilizing uberfx dependency injection framework work first combining component return pluginresult rootplugin type node struct node represents core structure celestia node keep reference celestiaspecific type node struct rootplugin serf arbitrary type collect return value plugins rootplugin rootplugin strictly serf type composes node struct provides plugins way force load desired plugin component type rootplugin struct type pluginresult interface function collect multiple plugin component func collectsuboutletss pluginresult rootplugin return rootplugin func collectcomponents fxutiloption return fxutilraw fxprovide fxannotate collectsuboutlets fxparamtagsgroupplugins creating plugin least one component must return pluginresult type pluginresult force call function func newpluginservice pluginresult initiallyempty teststr return struct also user must annotate fxutiloption plugins group tag func plug testplugin componentscfg config store store fxutiloption return fxutilraw fxprovide fxannotate newpluginservice fxresulttagsgroupplugins change tested please see test implementation test along refactored version optimints dalc change require breaking major release change require coordination celestia fork sdk celestiaappcore celestiaorg repository yes change dramatically affect optimints dalc work proposed consequence positive easier create custom application run top celestia allows developer create better custom celestianodes isolates added functionality service could potentially combined plugins help move towards goal reducing duplicate functionality coded optimints dalc negative add complexity likely add future engineering effort continue support feature perhaps intuitive familiar uberfx reference blocking refactor dalc first discussed current implementation initial issue