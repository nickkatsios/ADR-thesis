require kafka supporting multiple kafka version something quite trivial due way protocol designed apiversions message client able retrieve minimum maximum supported version api message broker critical part connection flow suggested done right connection established however message available kafka new record batch format introduced format offer better metadata control header support transaction info httpscwikiapacheorgconfluencedisplaykafkakipretrievingprotocolversion httpskafkaapacheorgdocumentationmessages library usable guaranteed fully working kafka although highly recommended always latest version available moment consequence might restrict people however make library bit reliable implementation record transported also get quite simplified since one format