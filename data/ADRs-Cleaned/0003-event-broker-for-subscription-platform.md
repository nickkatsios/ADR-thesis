event broker subscription platform deciders ben bangert phil booth ryan kelly shane tomlinson problem statement external oauth relying party rps firefox account user authenticate kept whether user still active subscription well knowing delete user data internal mozilla mozilla provides firefox service notification sqs queue event intended internal trusted suitable external rps solution concern new system referred fxa event broker store fxa related event distribute via webhooks relevant rps user accessed initial version described applies primarily external rps receive subscription change account deletion event solution built future expansion mind require event stream storage per user notification internal mozilla rps difficulty inherent solution lie store source truth rps user authenticated delivery functionality reside event stream user reside set data included firefox service notification data communicated delivery system avoid additional api query load existing fxa service driver subscription service deadline effort required experience available fxa change separation concern existing fxa microservices difficulty schema migration existing fxa microservices suitability existing fxa database largescale event storage architectural desire treat fxa auth oauth one merging inprogress considered implementing notification fxa auth service feature storing webhook login activity fxa auth service implementing notification new fxa event broker service storing webhook login activity fxa auth service storing webhook login activity fxa event broker outcome chosen implementing notification new fxa event broker service webhook login activity stored fxa event broker subscription platform timeline risk store new data new database modify existing fxa oauth database storing event scale database requirement dont fit well limitation mysql encountered fxa authoauth fxa auth store notify would require notification also include rps notify increasing load fxa auth database pro con implementing notification fxa auth service feature wwebhook login activity description fxa auth service additional feature code added perform webhook delivery rps fxa auth service store login activity webhook mapping oauth client pro auth service direct access subscription capability mapping oauth webhook url con event log user well suited existing mysql database additional database schema migration needed later feature needing query user event could impact fxa auth service availability implementing notification new fxa event broker service wwebhook login activity fxa auth service description fxa event broker performs webhook delivery rps fxa auth service store login activity webhook mapping oauth client fxa auth server includes rps notified relevant service notification fxa event broker cache new oauth client request indicates subscription capability per pro division event storing distribution service built specifically function con query fxa auth service required message determine whether deliver could impact fxa auth service availability fxa oauth server still record rps user logged later issue add still needed implementing notification new fxa event broker service wwebhook login activity fxa event broker description fxa event broker performs webhook delivery rps fxa event broker cache new oauth client request indicates subscription capability per fxa event broker log event determine rps user logged without external service query pro division event storing distribution service built specifically function con fxa oauth server still record rps user logged later issue add still needed