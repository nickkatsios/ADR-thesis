adr public api author wondertan renaynay changelog initial version additional detail celestia node built almost half year bottomup approach development core lower level component built first public api around getting organically shaped project maturing architecture better defined good time formally define set module provided node respective apis approach node type centric design another discussed approach defining api could onion style new layer feature set broader node type however turn approach seem match reality node type implement possible apis variable implementation matching resource constraint type design goal ergonomic simple idiomatic selfexplanatory module centricmodular api monolithic segregated different categorized independent module unified node type implement set apis difference defined different implementation module meet resource requirement type example fullavailability lightavailability embeddable simply constructable node library style api sdkframework dictate user way build app user decide want build app api language agnostic simple implement similar module interfacestraits language rpc client implementation tracking issue found provides detailed stepbystep process described design implemented highlevel description node type celestianode referred data availability node node whose sole purpose interact data availability network layer layer node contains functionality necessary post retrieve message layer mean node able query modify celestia state node able pay posting message network staterelated api documented detail furthermore interaction celestia consensus network celestia data availability network responsibility bridge node type however interaction exposed public level meaning bridge node expose api celestiacore node connected bridge node intent purpose provide api full node stubbedout module bridge node perform sampling detail service deprecation initial step deprecate service favor module headerservice headermodule organically moving towards direction modularized library share header state package getting shaped independent module lack api definition consistency semantically module closer celestias overarching project goal slogan disassociate centralization service always associated centralized infrastructure older monolithic service newer distributed microservice architecture module definition header type headermodule interface localhead return node local head tip chain header store localheadctx contextcontext headerextendedheader error getbyhash return header given hash node header store getbyhashctx contextcontext hash tmbyteshexbytes headerextendedheader error getbyheight return header given height available getbyheightctx contextcontext height uint headerextendedheader error waitforheight block header given height processed node header store deadline exceeded waitforheightctx contextcontext height uint headerextendedheader error getrangebyheight return given range fromto extendedheaders node header store verifies returned header adjacent getrangebyheightctx contextcontext uint extendedheader error subscribe creates longliving subscription newly validated extendedheaders multiple subscription created subscribecontextcontext chan headerextendedheader error syncstate return current state header syncer syncstatecontextcontext syncstate error syncwait block header syncer synced network head syncwaitctx contextcontext error networkhead provides syncers view current network head networkheadctx contextcontext headerextendedheader error share type sharesmodule interface getshare return share given data root given rowcol coordinate getsharectx contextcontext root root row col int share error geteds get full identified given root getedsctx contextcontext root shareroot rsmtdextendeddatasquare error getsharesbynamespace get share within given namespace share returned rowbyrow order namespace span multiple row getsharesbynamespace ctx contextcontext root root nid namespaceid sharenamespacedshares error sharesavailable subjectively validates share committed given data root available network sharesavailablectx contextcontext root root error probabilityofavailability calculates probability data square available based number sample collected probabilityofavailability float type ppmodule interface info return address information host infocontextcontext peeraddrinfo error peer return peer across inner store peerscontextcontext peerid error peerinfo return small slice information peerstore given peer peerinfocontextcontext peerid peeraddrinfo error connect ensures connection host peer given peer connectctx contextcontext peeraddrinfo error closepeer close connection given peer closepeerctx contextcontext peerid error connectedness return state signaling connection capability connectednessctx contextcontext peerid networkconnectedness natstatus return current nat natstatuscontextcontext networkreachability blockpeer add peer set blocked peer blockpeerctx contextcontext peerid error unblockpeer remove peer set blocked peer unblockpeerctx contextcontext peerid error listblockedpeers return list blocked peer listblockedpeerscontextcontext peerid mutualadd add peer list peer bidirectional peering agreement protected trimmed dropped negatively scored mutualaddctx contextcontext peerid tag string mutualadd remove peer list peer bidirectional peering agreement protected trimmed dropped negatively scored returning bool representing whether given peer protected mutualrmctx contextcontext peerid tag string bool ismutual return whether given peer mutual peer ismutualctx contextcontext peerid tag string bool bandwidthstats return stats struct bandwidth metric data sentreceived local peer regardless protocol remote peer bandwidthstatscontextcontext stats bandwidthforpeer return stats struct bandwidth metric associated given peerid metric returned include traffic sent received peer regardless protocol bandwidthforpeerctx contextcontext peerid stats bandwidthforprotocol return stats struct bandwidth metric associated given protocolid bandwidthforprotocolctx contextcontext proto protocolid stats resourcestate return state resource manager resourcestatecontextcontext rcmgrresourcemanagerstat pubsubpeers return peer peer joined given topic pubsubpeersctx contextcontext topic string peerid error nodemodule type nodemodule interface info return administrative information node infocontextcontext info error loglevelset set given component log level given level loglevelsetctx contextcontext name level string error authverify return permission assigned given token authverifyctx contextcontext token string authpermission error authnew sign return new token given permission authnewctx contextcontext perm authpermission byte error type dasmodule interface stats return current stats daser stats dassamplingstats error state type statemodule interface accountaddress retrieves address node accountsigner accountaddressctx contextcontext stateaddress error balance retrieves celestia coin balance node accountsigner verifies corresponding block apphash balancectx contextcontext statebalance error balanceforaddress retrieves celestia coin balance given address verifies returned balance corresponding block apphash balanceforaddressctx contextcontext addr stateaddress statebalance error submittx submits given transactionmessage celestia network block included block submittxctx contextcontext statetx statetxresponse error submitpayforblob build sign submits payforblob transaction submitpayforblob ctx contextcontext nid namespaceid data byte fee typesint gaslimit uint statetxresponse error transfer sends given amount coin default wallet node given account address transfer ctx contextcontext typesaddress amount typesint fee typesint gaslimit uint statetxresponse error statemodule also provides stakingmodule stakingmodule ideally state module implemented top statemodule way abstract state requesting method yet staking type stakingmodule interface delegate sends user liquid token validator delegation delegate ctx contextcontext deladdr statevaladdress amount stateint fee typesint gaslim uint statetxresponse error beginredelegate sends user delegated token new validator redelegation beginredelegate ctx contextcontext srcvaladdr dstvaladdr statevaladdress amount stateint fee typesint gaslim uint statetxresponse error undelegate undelegates user delegated token unbonding current validator undelegate ctx contextcontext deladdr statevaladdress amount stateint fee typesint gaslim uint statetxresponse error cancelunbondingdelegation cancel user pending undelegation validator cancelunbondingdelegation ctx contextcontext valaddr statevaladdress amount typesint height typesint fee typesint gaslim uint statetxresponse error querydelegation retrieves delegation information delegator validator querydelegation ctx contextcontext valaddr statevaladdress typesquerydelegationresponse error queryredelegations retrieves redelegations delegator validator queryredelegations ctx contextcontext srcvaladdr dstvaladdr statevaladdress typesqueryredelegationsresponse error queryunbonding retrieves unbonding delegator validator queryunbonding ctx contextcontext valaddr statevaladdress typesqueryunbondingdelegationresponse error fraud type fraudmodule interface subscribe subscribes given fraud proof type subscribeproof fraudprooftype error list list proof type fraud module currently subscribed list fraudprooftype get return stored fraud proof given type getproof fraudprooftype proof error metric type metricsmodule interface list show registered meter listctx string error enable turn specific meter enablestring error disablestring error exportto set endpoint metric exported exporttostring nice postmainnet staterelated module eventually would nice break statemodule statemodule bankmodule stakingmodule state general type statemodule interface queryabci proxy generic abci query core endpoint queryabcictx contextcontext request abcirequestquery coretypesresultabciquery error submittx submits given transactionmessage celestia network block included block submittxctx contextcontext statetx statetxresponse error bank type bankmodule interface balance retrieves celestia coin balance node accountsigner verifies corresponding block apphash balancectx contextcontext statebalance error balanceforaddress retrieves celestia coin balance given address verifies returned balance corresponding block apphash balanceforaddressctx contextcontext addr stateaddress statebalance error submitpayforblob build sign submits payforblob transaction submitpayforblob ctx contextcontext nid namespaceid data byte gaslimit uint statetxresponse error transfer sends given amount coin default wallet node given account address transfer ctx contextcontext typesaddress amount typesint gaslimit uint statetxresponse error staking premainnet staking module type stakingmodule interface delegate redelegate unbond cancelunbond querydelegation queryredelegation queryunbondingdelegation account type accountmodule interface add delete show list sign export import proposed