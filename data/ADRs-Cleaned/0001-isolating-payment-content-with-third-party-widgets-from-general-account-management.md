isolating payment content thirdparty widget general account management deciders ben bangert ian bicking wil clouser orchard shane tomlinson problem statement implementation payment feature subscription service weve decided thirdparty javascript payment widget best practice established security team indicate thirdparty included highlysensitive page general account management firefox account way isolate page responsible subscription signup management rest firefox account driver security dealing financial transaction security including thirdparty code payment widget simplicity user experience flow delivering subscription service deadline considered payment page separate app supplied pregenerated access token payment page separate app normal oauth relying party paymentrelated content embedded iframes pregenerated access token passed via postmessage payment page normal fxa content iframes isolate thirdparty widget outcome chosen payment page separate app supplied pregenerated access token refinement access token delivery mechanism significantly affect rest payment app doesnt preclude upgrade future issue resolved doesnt preclude future offering embedded subscription widget thirdparties fastest practical given existing record review security work completed far fresh start modern web stack react pro con payment page separate app supplied pregenerated access token description payment page standalone web app paymentsfirefoxcom access token generated via fxacontentserver accountsfirefoxcom access fxaauthserver subscription apis access token conveyed payment page directly via url parameter alternatively access token conveyed indirectly via code exchange secure mechanism pro effectively isolate thirdparty widget virtue living separate origin receiving scoped access token original plan record reviewed security team time already spent allows build something scratch modern framework like react con building something react novel project overall stand yet another server payment page separate app normal oauth relying party description payment page standalone web app paymentsfirefoxcom payment page full oauth relying party usual login flow requesting scope access fxaauthserver subscription apis access token acquired via standard oauth mechanism pro effectively isolate thirdparty widget virtue living separate origin receiving scoped access token allows build something scratch modern framework like react con open issue support promptnone openid connect login left unresolved issue mean accessing payment page result redundant login prompt flow building something react novel project overall stand yet another server paymentrelated content embedded iframes pregenerated access token passed via postmessage description payment content hosted separate domain paymentsfirefoxcom embedded iframes fxacontentserver page accountsfirefoxcom access token generated via fxacontentserver accountsfirefoxcom iframepostmessage api pas access token payment content pro effectively isolate thirdparty widget virtue living separate origin receiving scoped access token con stand yet another server least separate origin security story around iframes origin user management page reviewed additional time needed seems awkward fit flow drafted far subscription management signup would likely content built backbone requiring modernization later unless combined react backbone fxacontentserver clean separate app payment page normal fxa content iframes isolate thirdparty widget description payment page hosted within fxacontentserver accountsfirefoxcom involved paymentsfirefoxcom host created iframes embed isolate thirdparty widget session token usual api authentication access token required pro requires fewest novel technology choice reuse existing fxacontentserver con security story around iframes origin user management page reviewed additional time needed would likely content built backbone requiring modernization later unless combined react backbone fxacontentserver clean separate app link shanes earlier securing payment page google doc