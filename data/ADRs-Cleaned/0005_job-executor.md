title joex job executor weight problem statement docspell multiuser application processing user document must thought distribute processing job much restricted set resource maybe user core process document time simply fifo enough since provides unfair distribution first user submits document occupy core quite time user would wait try find fair distribution among user strictly meaning collective docspell job executor separate component run process take next job queue executes associated task run document processing job text extraction text analysis etc task execution survive restarts state task code must recreated persisted state processing fair respect collective must possible run many job executor possibly different machine quickly enable processing power removing peak task execution fail able retry task reason error may temporarily example talking third party service enable repairing without stopping job executor error might easily repaired program installed whatever case good know task retried later considered contrast adrs sketching thought current implementation job description serialized written database table becomes queue task identified name job executor implementation must map name code lookup task perform task argument serialized string written database task must decode string conveniently done json provided circe decoder provide fair execution job organized group new job requested queue first group selected roundrobin strategy ensure good enough fairness among group group map collective within group job selected based priority submitted time fifo job state see note stuck job allowing multiple job executor mean getting next job fail due simultaneous running transaction retried succeeds taking job put scheduled state job executor unique manually supplied job marked handed executor task fails state updated state stuck stuck job retried future queue prefers return stuck job due specific point time ignoring priority hint detail job property something random group taskname choose task run submitteddate worker job executor state one waiting scheduled running stuck cancelled failed success waiting job inserted queue scheduled job handed executore marked job executor running task currently executing stuck task failed retried eventually cancelled task finished cancel request failed task failed execeeded retries success task completed successfully queue take nextjob operation take workerid priority hint roughly like select next group roundrobin strategy select job group state stuck waiting time elapsed state waiting given priority possible job ordered submitted time stuck job whose waiting time elapsed preferred two priority within group high low configured counting scheme determines select certain priority example counting scheme would select two high priority job low priority job take operation try prefer priority fall back job priority available group corresponds collective collective get roughly equal treatment job queue executor sleep must waked run job submitted executor notified stuck job job going stuck state task failed state task rerun maximum retry count reached problem notify executor waiting time elapsed one executor put job stuck state mean others start looking queue minute would possible tell existing executor schedule wake future would miss executor show later waiting time increased exponentially retry retry meant minimum waiting time executor wakeup periodically check new work time necessary fallback stuck job queue nothing submitted long time system job get submitted would awake executor