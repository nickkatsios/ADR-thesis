adr preblock changelog sept initial draft draft abstract introduce preblock run begin blocker module allows modify consensus parameter change visible following state machine logic upgrading sdk storage format consensus parameter changed migration block ctxconsensusparams always nil fails load old format new code supposed migrated xupgrade module first unfortunately migration happens beginblocker handler run ctx initialized try solve find xupgrade module cant modify make consensus parameter visible module passed value sdk team want keep way thats good isolation module alternative first alternative solution introduced migratemodulemanager includes xupgrade module right baseapp run beginblockers module reload consensus parameter suggested new lifecycle method preblocker two semantics around new lifecycle method run beginblocker module modify consensus parameter storage signal caller return value return consensusparamschangedtrue caller must refresh consensus parameter finalize appfinalizeblockstatectx appfinalizeblockstatectxwithconsensusparamsappgetconsensusparams new ctx must passed lifecycle method consequence backwards compatibility positive negative neutral discussion test case reference httpsgithubcomcosmoscosmossdkissues httpsgithubcomcosmoscosmossdkpull httpsgithubcomcosmoscosmossdkpull httpsgithubcomcosmoscosmossdkpull