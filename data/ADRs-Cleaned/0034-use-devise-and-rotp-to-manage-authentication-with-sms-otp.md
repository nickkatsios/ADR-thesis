devise rotp manage authentication otp supercedes auth authentication supercedes omniauth standardise authentication previously auth via omniauth manage user session user requirement require multifactor authentication onetime password sent auth planning moving feature included expensive enterprise plan create devise strategy rotp generate onetime password sent via govuk notify consideration made tested assumption otp requirement decided auth cost enterprise high explored competitor auth ever planning supporting sso decided running external service even bought unnecessary overhead considered writing authentication system rail scratch decided devise give enough box warrant considered devisetwofactor would require enough bending ignore appbased mfa add otp process flow make sense write strategy considered retaining omniauth middleware enable easily provider believe future