attempted every error component cloud foundry deployment error single yaml file strict prewritten message due overwhelming number error seemingly arbitrary error code inflexible message neither client developer wholly pleased order improve message flexibility switched error type specific module created translate generic api error unprocessable entity see figure controller level theory gave benefit knowing possible amount creating custom error message unprocessable entity detail relationship hash title cfunprocessableentity code figure currently cloud foundry api present error jsonencoded string three field detail title code however client typically detail field determine exact type error pain client example cloudfoundry cli forced complicated branching logic see figure catch interpret capi error message order able type check error code drawback detail field freeform string thus brittle capi wanted change error message product reason could potentially break cli code path aim retain helpful specific error message also providing additional lower high level information directly applies client propose making greater code title field error break commonly umbrella categorization error new class error different title code maintaining customized error message example common workflow cli swallowing capi uniqueness constraint error create action maintain idempotent behavior instead searching unique error string capi return resource cli currently would match generic capi error figure unprocessable entity detail custom error message title notuniqueerror code figure error new error sub class http error title code would give client high level information caused error detail would still custom string flexible product could many case returned directly user implementation majority error triggered modelvalidation typical example shown figure def createmessage organization redacted rescue sequelvalidationfailed validationerrore message end def validationerrorerror message errorerrorsonorganizationid nameincludeunique errorspace quota messagename already exists end errorerrormessage end figure full code snippet found error converted usual cfunprocessableentity error figure def create redacted spacequota spacequotascreatenewcreatemessage organization org render created json presentersvspacequotapresenternew spacequota visiblespaceguids permissionqueryerreadablespaceguids rescue spacequotascreateerror unprocessableemessage end figure full code snippet found proposal raise new class error cloudcontrollerspacequotascreate return directly user figure def validationerrorerror message errorerrorsonorganizationid nameincludeunique cloudcontrollererrorsapierrornewfromdetailsnotuniqueerror space quota name must unique organization end errorerrormessage end def create redacted spacequota spacequotascreatenewcreatemessage organization org render created json presentersvspacequotapresenternew spacequota visiblespaceguids permissionqueryerreadablespaceguids rescue spacequotascreateerror unprocessableemessage end figure note function error defined validationerror return error type error scoped module spacequotascreate type rescuing controller changing type error raised action desired type return error directly client example final message string already set action lose anything also defining type well aim define every possible type error class might encourage future developer reuse error create error might detailed information case might better leave information client detail string break pattern dangerous way maintaining pattern structure api also priority aim find commonly logical unit error simple separate first iteration plan extract error condense error branching cli much possible break case needed based future request user feedback consequence benefit would benefit client cli resorted large case statement untangle type error see figure case stringscontainserrorstring route already exists return ccerrorroutenotuniqueerrorunprocessableentityerror err figure full case statement different check notunique error would replaced single check making code simpler understand robust case errorresponsecode return ccerrornotuniqueerror concern potential create api error specialized place thrown rather highest level careful liberal pattern might end inconsistency around throw error throwing api error directly action uniqueness validation constraint case rescuing generic spacequotacreateerror case example error umbrella might ambiguous might unclear umbrella future error would placed would much flexibility restructure entering error type contract client unclear existing client dependent cfunprocessableentity error structure existing way