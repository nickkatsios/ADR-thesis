api prefix materialized jetstream view metadatavalue author mhanel partially implemented tag jetstream client objectstore document describes design support api prefix materialized view api prefix allow client library disambiguate access independent jetstreams run either different domain different account specifying prefix api client program essentially pick one want communicate mechanism supported materialized view well overview jetstream listens default api subject prefix jsapi thus client jsapi communicates jetstream local account domain avoid traffic going jetstream following mechanism place account since api imported altered prefix request cross account boundary jetstream enabled account import without prefix set result error jetstream imported well error import overlap domain leaf node connection nats server add denies jsapi client library set api prefix api subject client publishes subscribes start instead jsapi result api traffic end local jetstream alway ever subscribes jsapi message subscription cross boundary following happens account crossing import api prefix stripped replaced jsapi domain crossing leaf node connection domain automatically inserted mapping strip api prefix replaces jsapi jetstream disambiguation mechanism added materialized view object store well specifically tag along api prefix setting different value reach jetstream non starter design first token api materialized view considered default api prefix mean local semantics thus concrete view treat token obj respective default api prefix publishes subscribes api replaces first token specified non default prefix share api access across account sufficient account exportimport take care rest access api account different domain natsserver maintaining leaf node connection add appropriate mapping domain specific api local api deny local api traffic example assume api prefix jetstream set jsfromacc jetstream specific api call local api prefix jsapi replaced jsfromacc jetstream specified api prefix differs jsapi api prefix specififed jetstream api api prefix jsfromacc resulting jsfromacckv thus order put key bin bin send jsfromacckvbinkey crossing account boundary translated back kvbinkey thus underlying stream still created subscription kvbinkey domain special case api prefix work way api prefix jsdomainnameapi lead jsdomainnameapikvbinkey leaf node connection domain crossed inserted mapping change subject back kvbinkey consequence proposed change backwards compatible materialized view already suggested prefixing one prefix across different apis avoid accidental api overlap going forward implication jetstream start first token api prefix specifically jetstream never expose functionality jsapikv version api prefix would look follows jsfromacckv clash subject side effect jetstream two token api prefix materialized view single token problem avoided unifying api name space alway two token second token api resulting jsapi kvapi objapi however backwards compatible testing server config test change jetstream prefix froma inbox prefix fori jetstream enabled account user user password jetstream enabled export service jsapi service stream fori user user password import service account subject jsapi froma service account subject fromakv stream subject fori account test jetstream connected account talking jetstream account nats account info natsiilocalhost jsapiprefix froma publishes subscribes support prefix well absent actual implementation simulated pubsub implementation able connect account access map ojbjects account nats natsaalocalhost sub kvmap sleep nats natsiilocalhost pub fromakvmapput hello world