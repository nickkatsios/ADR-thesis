repository library design built top metadata api problem statement metadata api provides modern python api accessing individual piece metadata provide wider help someone looking implement tuf repository legacy pythontuf implementation offer tool suffers issue many implementation large amount code maintain repopy repositorytoolpy repositorylibpy alone almost line code library like part implementation form good coherent api method routinely large number argument code still depends globals major way application repopy still implement lot repository code library like part implementation make look like application example repositorytool load every metadata file repository fine cli operates small repository unlikely good choice large scale server driver consensus removing legacy code pythontuf due maintainability issue metadata api make modifying metadata far easier legacy code base make significantly different design possible providing repository library leaving implementers may short term solution previous point make adoption easier help adopter create safe implementation project would benefit shared repository code shared repository design maintainability new library code must top concern allowing wide range repository implementation cli tool minimal inmemory implementation large scale application server would good unfortunately wildly differing requirement considered repository package repositorytool like api minimal repository abstraction outcome minimal repository abstraction might temporarily goal implement minimal repository abstraction soon possible give project path forward maintenance burden reasonable result usable soon pythontuf repository functionality later extended idea experimented upstream project pythontuf example code concept still unproven validating design straight forward could reevaluated month week pro con repository package metadata api make editing repository content vastly simpler already repository implementation built clearly repository library absolute requirement providing repository package pythontuf mean external project could experiment create implementation without adding maintenance burden pythontuf would easiest way iterate many different design hopefully find good one end said tricky part repository maintenance initialization snapshot update hashed bin management would benefit canonical implementation easier adoption pythontuf reference implementation likewise well designed library could make repeated action version bump expiry update signing much easier manage repositorytool like api wont possible support repositorytool api similar one would certainly would likely easiest upgrade path repositorytool user implementation would huge amount work metadata api make many thing easier however repositorytool part repopy great api likely similar api suffers issue might end substantial amount code good fit one application minimal repository abstraction pythontuf could define tiny repository api provides carefully selected core functionality like core snapshot update implement repository action instead make easy application code leaf application detail specific implementation example library always decide target stored repo version metadata stored load metadata unload metadata bump metadata version new expiry target version part new snapshot pythontuf could also provide one implementation abstraction example could include repopy repositorytoollike implementation could compromise allows low maintenance burden pythontuf initial library could tiny sharing important canonical part tuf repository implementation ergonomic repository modification meaning action core code different repository implementation core code abstract api approach downside drop replacement repositorytool repopy prototype implemented see link concept still unproven detail design document link design document minimal repository abstraction prototype implementation minimal repository abstraction pythontuf test inmemory implementation repositoryeditorfortuf external command line repository maintenance tool