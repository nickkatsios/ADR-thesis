httpswwwpivotaltrackercomstoryshow described pattern defining security group service vms connect involved creating client security group service service allowed connection client security group applied vms needed able connect problem case would add several client security group given risk running aws limit default max group per interface alternative approach security group defined component component group system service define rule allowing connection component access instance component client service provider service security group role approach number advantage number security group applied driven number component number thing connect number component likely small better able control control number thing component talk easier see component connect given service looking rule service security group moving component vms much clearer security group move consequence enable avoid hitting aws limit number security group applied given interface make clearer component allowed connect given service work update existing group pattern potential issue there possibility cycle terraform dependency graph component initiate connection avoided awssecuritygrouprule terraform resource instead defining rule inline awssecuritygroup looking given harder see service connects seen major problem possible create tooling visualise without much effort