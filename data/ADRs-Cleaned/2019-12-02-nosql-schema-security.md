nosql schema firestore security rule deciders eimi updated technical story related needing rethink design database schema balance ease security implementation easy problem statement security rule firebase globlike service cloudfirestore match databasesdatabasedocuments match somepath allow read write somecondition add user authentication conditional statement tighten security access data mean might rethink want organise data initially thought flat text usersuid projectspid transcriptstrid papereditspeid uploadsupid retained flatness easy access data however complicate data structure retaining user record driver security ease implementation ease implementation security rule extensibility considered flat collection user every collection field user rest subcollections collection user project user field rest subcollections outcome chosen collection thinking membership extensibility wed want able multiple user single project every asset transcript paperedits associated project authenticate user based field project called user project several user like projectsidusers security rule like able test authentication membership project user function isonproject return requestauthuid getdatabasesdatabase document project piddatausers uploads storage firestore uploads subcollection added user security convenience storage rule lot easier implement based user want make thing symmetric possible firestore storage usersiduploadsupid usersiduploadsupid keep consistency also transcript uploads firestore firestore firestore projectsidtranscriptsitemid usersiduploadsitemid schema related structure project follows firestore projectsidtranscriptstrid projectsidpapereditspeid projectsidlabelslid projectsidtranscriptstridannotationsaid collection project collection document contains field type string title string description string updated timestamp url string user array string paperedits collection transcript collection label collection paperedits collection document contains field type string projectid string title string description string created timestamp updated timestamp url string element array map element title note voice element field type string index number type string text string paper cut element field type string transcriptid string index number type string start number end number infer word paragraph transcript collection transcriptid start end time transcript collection document contains field type string projectid string title string description string medium map string created timestamp updated timestamp url string word array map paragraph array map annotation collection url react transcript editor interface medium map field type url string type string type either video audio word map field type start number end number text string paragraph map field type number start number end number speaker string annotation collection document contains field type string projectid string transcriptid string labelid string start number end number note string label collection document contains field type string projectid string label string description string value string color string