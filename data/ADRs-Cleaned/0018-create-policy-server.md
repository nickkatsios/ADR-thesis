create policy server manage network policy well implemented service oriented apps typically include backend service never serve request user client outside foundation currently app reach backend service backend service must expose ingres gateway app must hairpin ingres gateway reach security concern backend apps accessible outside foundation vms provides api mechanism configuring apps permitted communicate apps called network policy job provides api called policyserver database api endpoint cli communicates kubernetes provides networkpolicy resource serf similar outcome objective create kubernetes networkpolicy network policy background see exploration document write new stateless component implement existing network policy api endpoint read write kubernetes networkpolicy directly api server store rather maintaining database specific implementation detail example command example resource see exploration document consequence api server source truth network policy effectively making network policy kubernetes networkpolicy one entirely builtin kubernetes resource add external dependency component may also write modify sidecar resource foundation istio sidecar sidecar currently configured app app communication path import cfforvms policyserver database cfforks new component conform new observability initiative incl distributed tracing work capi configuration traced well