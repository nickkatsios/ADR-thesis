building object main factory problem statement create instance class application pas dependency constructor ensure object shared others created every time needed driver want object creation typesafe able code intelligence feature ide strict type checking php static analysis capability phpstan want object creation support adhering solid principle single responsibility principle lead lot class depending hierarchy also instance creation solution separate concern instantiation class openclosed principle solved interface make necessary create different instance interface support switching instance testing dontrepeatyourself principle mean one place class instantiated edgeedge integration test environment resembles production environment closely possible still able switch service isolate side effect database content filesystem randomness etc want keep public api code method exposed web command line framework code small possible ideally api expose case considered adhoc instantiation new pimple dependency injection container come silex framework creating central factory outcome consequence chose central factory class called funfunfactory typesafety ide comfort autocompletion trumped concern boilerplate also saw binding specific library framework plus still pimple dic internally get shared object wrapped access instance pimple typesafe getters hindsight pimple holder shared object turned bad idea creation function build object far away code request easy way jump getter creation function realized switched pimple createsharedobject function refactor creation function naming convention give consumer hint object shared singleton newly created method starting get return shared object method new return fresh object every call extracted case bounded late stage project attempted split factory case contextfactory class attempt halfhearted difficult since underlying dependency connection entity manager make sense application bounded funfunfactory become long disorganized unfortunately pay attention boundary across bounded abstraction layer apply naming convention consistently funfunfactory contains setter make possible switch implementation testing also set environmentspecific service like logging see class wmdefundraisingfrontendfactoriesenvironmentsetup namespace architectural perspective bad since potentially allows controller switch service shouldnt allowed pro con adhoc instantiation new static construction method see matomo code base whenever class service lead severe problem dependency configurable making class harder test duplicate instantiation code base leading inconsistency shotgun surgery whenever constructor class change pimple dependency injection container pimple arrayaccess interface organize dependency create object inside anonymous function assigned array key code access array key pimple call creation function return created instance caching future access creation function get container parameter get dependency good class shared default good wellintegrated silex framework bad type checking type hint could partially overcome extensive property docblocks would far away creation function bad concept public private instance central factory good type safe good follow object tree construction jump definition movement editoride good define whats public whats private bad factory function almost every class bad enforce much structure allow pattern singleton wrapper link drawback choice improved upon adr