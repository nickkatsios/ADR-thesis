title file type weight problem statement docspell currently support pdf file simplified early development design lot helped starting project handling pdf file usually easy view extract text print etc pdf format chosen pdfs file common viewed many tool many system nonproprietary tool docspell also document archive perspective important document viewed year hope pdf format best suited therefore document docspell must accessible pdf trivial solution requirement allow pdf file support document type must take care following extracting text converting pdf access original file text extracted source file case conversion lossless since docspell already extract text pdf file ocr text also extracted converted file fallback original file must always accessible main reason uploaded data accessible without modification since conversion may always create best result original file kept driver people expect software like docspell support common document type like office document docx rtf odt xlsx image many people common create file instead pdf older scanner may able scan pdf file image file considered adr evaluate different rather document feature realized thought lead implemented realization data model attachment table hold one file another table attachmentsource hold original file look like sql create table attachmentsource varchar null primary key fileid varchar null filename varchar created timestamp null foreign key fileid reference filemetaid foreign key reference attachmentattachid primary key associated attachment creating relationship well correct attachment attachmentsource always attachmentsource record every attachment record original file pdf already table fileid column point file user change filename attachment original filename preserved attachmentsource must possible user change anything attachmentsource attachment table touched order keep current code mostly unchanged simpler data migration downside data model allows attachment record without attachmentsource record otoh foreign key inside attachment pointing attachmentsource also correct allows attachmentsource record associated many attachment record would even harm opinion migration creating new table altering existing one simplify data migration since pdf file allowed user could change anything attachment table existing data simply inserted new table present trivial case attachment source processing first step processing converting file pdf already pdf nothing done step text extraction text first tried extract source file fails supported text extracted converted pdf file remaining step untouched conversion supported input file skipped conversion fails error propagated let retry mechanism take care type file type supported first step major office document common image plain text markdown html supported term file extension doc docx xlsx odt html txt jpg png tif always preference jvm internal library order platform independent reduce external dependency always possible like ocr figurefileprocessfilespng conversion office document doc docx xlsx odt unoconv see adr html html wkhtmltopdf see adr textmarkdown txt javalib flexmark wkhtmltopdf image jpg png tif tesseract see adr text extraction office document doc docx xlsx apache poi office documends odt apache tika including source html supported extract text converted pdf image jpg png tif tesseract textmarkdown pdf apache pdfbox tesseract link convert html file convert plain text convert office document convert image file extract text file