utilizing jsonschemas semver tooling json messaging deciders ben bangert jared hirsch ryan kelly shane tomlinson problem statement firefox account sends receives message json utilizing queue adr address usecase apply json restful apis tracking minimizing drift accuracy message format documentation underlying implementation errorprone process addition json message frequently produced consumed multiple system multiple langauges ensuring validity message frequently requires implementing validation logic language consumes json message ensure correctness message handling adding field message format nontrivial every consumer must also update validation logic currently variety place message consumed produced producer validate message send consumer code always service validation code typically resides currently versioning message format also creates difficulty knowing validation logic must change existing flexibility sufficient driver accurate documentation via jsonschema doc generation validation logic generated jsonschema reduce manually writtenmaintained code semantic versioning effectively communicate breaking nonbreaking message format change considered keep existing approach protobuf formatvalidatedocument message format jsonschemas semver docvalidation existing json message format outcome chosen existing message represented without migration needed external consumer already work json keep existing approach currently documentation drift message format tweaked doc updated ideally code review process would catch sometimes code subleties caught alter message format validation change also fail appear documentation even though considered valid message keyvalue documented occasionally duplicate joi schema repos likely moved fxashared benefit reuse help nonnode project consume message pro additional work needed dont already con documentation frequently drift additional work maintain accurate joi schema spread throughout codebase additional work consolidate joi schema fxashared joi schema cant consumer written protobuf protobuf would allow validate document valid message format would also consume space performant serializedeserialize validation builtin invalid message deserialize documenation generated based protobuf spec message protobuf tooling widely available langauges pro high throughput messaging could benefit higher efficiency serializingdeserializing message documentation stay sync message spec validation builtin message serializationdeserialization process con message binary easily introspectable existing message consumer updated handle protobuf migration procedure createdimplemented shift existing json format jsonschemas jsonschemas define existing fxa json message queue system library language consume schema validation purpose library exist generate documenation jsonschema schemaver introduced existing fxa json message consumer ignore unknown key consumer jsonschema verify handle new message format theyre incompatible logic manual schemaver official part jsonschema specification recommendation schemaver best web practice data pro change needed existing consumer validation done based jsonschema without custom code documentation generated stay sync message spec json human readable without processing json widely web increasing jwts also result json jsonschema widely supported variety langauges con schemaver draft isnt officially jsonschema committee versioning scheme jsonschema appear exist writing