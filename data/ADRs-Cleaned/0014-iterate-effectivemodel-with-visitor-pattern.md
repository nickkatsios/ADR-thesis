iterate effectivemodel visitor pattern user story effectivemodel graph contains node arbitrary type consumer iterate node without loosing type information considered instanceof double dispatch visitor pattern outcome chosen double dispatch visitor pattern come best see pro con instance combination instanceof switchif statement whenever want iterate node java node instanceof webserver dosomethingnode straightforward really ugly boilerplate double dispatch visitor pattern clean extendable java default method interface code reuse easier make architecture bit complex boilerplate tosca element every class accept method