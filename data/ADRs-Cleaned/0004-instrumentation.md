implement instrumentation via new api endpoint external hoc probe calculation proposed deciders christina harlow linh nguyen rob miller technical story httpsgithubcommozillaglamissues problem statement order help various product overall product quality want understand glam normally fit typical user workflow starting point endpoint something accomplish gathering data typical user session look like least looked probe probe browsing behaves short long period time whether correlate event certain product release additionally timesensitive issue glam etl lot work take hour complete intend reduce glam etl time finding probe likely requested user aforementioned data etl build probe document also present plan hoc probe building happen someone request probe prebuilt etl driver usage metric collection must reliable cannot bypassed influenced system browser blocker glam etl consume service optimize work processing probe likely looked glam app consume service trigger hoc calculation whenever probe processed glam etl requested hoc probe building independent glam app likely cpumemory intensive different term scalability considered collect metric front end via library open telemetry instrumentation custombuilt solution send glam back end server stored table glam app postgres expose meaningful api endpoint usage data consumption glam app glam etl provides flexibility adapt future requirement immunity adblockers might longer implement gleanjs library telemetry would quicker custom implementation also good dogfooding internal support bypassed adblockers work around issue metric sent custom endpoint glams domain google analytics currently available quick easy implement doesnt give insight sessionscoped data make resilient adblockers sending metric endpoint order wed implemet google measurement protocol backend process metric properly even achieve wed still want current keep working involves sending metric google endpoint hence making vulnerable adblockers one way capture glam metric custom endpoint start grow way beyond scope work instead glams postgres save metric bigquery table would make easy etl consume data likely slow glam app operation due bigquerys slowerthanoltp response time stackdriver gcloud monitoring tool would provide interface exporting metric ability create dashboard visualizing since case also involves consumption metric glam app etl might get complicated parse response gcloud apis compared custom api outcome registering providing usage data chosen choice frontend library record metric urgent said meet driver criterion thing dont change lean towards gleanjs primary solution open telemetry backup plan case big hurdle hoc probe building solution proposed asynchronous requestreply pattern link link section worker external cloud component tbd access bigquery table building needed probe save built probe appropriate table postgres communicates glam app table also postgres visual picture complete solution description relevant flow please refer diagram link link solution diagramhttpsdocsgooglecomdocumentdvchlqboezuufioroxcvpdimxnjegyulhvoedituspsharing open telemetry instrumentationhttpsopentelemetryiodocsinstrumentationjsinstrumentation asynchronous requestreply patternhttpsdocsmicrosoftcomenusazurearchitecturepatternsasyncrequestreply