deciders ben bangert dan schomberg consulted barry chen wil clouser informed fxa team google cloud task job queueing problem statement many account related task require interaction multiple system may exceed typical request deadline task require additional guarantee fail may partially complete erroring require retry also occasionally run case there many thousand million task complete handled splitting list argument running parallel across many node manually sres another challenge weve faced running large quantity task batch manner ensuring rate limit adverse system condition arent hit type task handling typically handled large system jobtaskqueue system track job retry fail inspect failed job limit rate theyre processed fxa sqssns messaging taskevent distribution system built queueing task processing job reliable manner immediate problem want run large quantity task reliable manner effective rate limiting later wed like able queue task sending email complete reliably hold request processing ideally manner programming language dependent email sent separately sub plat team without needing replicate email handling functionality problem past message queue neither google pubsub aws sqs way inspect message may stuck queue driver rate limiting job processing job retries avoid additional service requiring operational support task deduplication task inspection queue scheduling task future programming language agnostic considered push based system push task queue task handler process avoids setup separate service task processor would pull job queue pull based require separate deployment sre job processor pull task queue google cloud task push based google pubsub push based bullmq redis pull based database table task pull based outcome chosen google cloud task meet criterion cost effective manner minimal risk already utilize variety google cloud platform service pro con google cloud task good existing api node process task additional job processor service good centralized rate limiting mean easily rate limit overall processing task regardless many node processing good meet criterion driver list good push based mean there central rate lmiting control instead calculate amongst job processor good http api task well supported calling method fxa bad new system dont prior experience mozilla bad google cloud platform service would impact ability migrate different cloud provider bad http task akin http api call different request thus preventing code reuse requiring workarounds google pubsub good existing api node process task additional job processor service good retry failed job good programming language agnostic neutral message delayed isnt flexible task scheduling bad there central rate limiting wed calculate processor bad there task deduplication bad task cant introspected queue bullmq redis good there task deduplication good there central rate limiting good portable cloud provider bad there central rate limiting wed calculate processor bad job processor setup pull job bad another redis instance focused job queue bad bullmq node queuing task processing database table task good already experience mysql good portable cloud provider bad another database setup administrated bad existing library arent popular bad there rate limiting included