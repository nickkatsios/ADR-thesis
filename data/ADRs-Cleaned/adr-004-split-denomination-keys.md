adr split denomination key changelog initial version alteration handle vesting account update review feedback update implementation glossary denom denomination key unique token identifier permissionless ibc anyone able send arbitrary denomination account currently nonzero balance stored along account sdkcoins struct creates potential denialofservice concern many denomination become expensive load store time account modified see issue additional simply rejecting incoming deposit denomination count limit doesnt work since open griefing vector someone could send user lot nonsensical coin ibc prevent user receiving real denomination staking reward balance shall stored peraccount perdenomination denomination accountunique key thus enabling read write access balance particular account particular denomination account interface xauth getcoins setcoins removed account interface since coin balance stored managed bank module vesting account interface replace spendablecoins favor lockedcoins require account balance anymore addition trackdelegation accept account balance token denominated vesting balance instead loading entire account balance vesting account continue store original vesting delegated free delegated vesting coin safe since cannot contain arbitrary denomination bank keeper xbank following apis added xbank keeper getallbalancesctx addr accaddress coin getbalancectx addr accaddress denom string coin setbalancectx addr accaddress coin coin lockedcoinsctx addr accaddress coin spendablecoinsctx addr accaddress coin additional apis may added facilitate iteration auxiliary functionality essential core functionality persistence balance stored first address denomination reverse also possible retrieval balance single account presumed frequent var balancesprefix bytebalances func keeper setbalancectx addr accaddress balance coin error balanceisvalid return err store ctxkvstorekstorekey balancesstore prefixnewstorestore balancesprefix accountstore prefixnewstorebalancesstore addrbytes marshalbalance accountstoresetbytebalancedenom return nil result balance indexed byte representation balancesaddressdenom delegatecoins undelegatecoins altered load individual account balance denomination found undelegation amount result mutation account balance made denomination subtractcoins addcoins altered read write balance directly instead calling getcoins setcoins longer exist trackdelegation trackundelegation altered longer update account balance external apis scan balance account retain backwardscompatibility advised apis getbalance setbalance instead getallbalances possible load entire account balance supply module supply module order implement total supply invariant scan account call getallbalances xbank keeper sum balance check match expected total supply consequence positive read writes balance respect number denomination account nonzero balance note relate actual cost rather total number direct read needed negative slightly efficient readswrites reading writing balance single account transaction neutral none particular reference ref httpsgithubcomcosmoscosmossdkissues ref httpsgithubcomcosmoscosmossdkissues ref httpsgithubcomcosmoscosmossdkissues