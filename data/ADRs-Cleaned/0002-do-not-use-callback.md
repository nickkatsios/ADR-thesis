callback public api decided callback handle modified file real code php thiswatcherwatchthispaths function modifiedfile file asynccallfunction file job thisindexergetjobfilepath foreach jobgenerator file yield new delayed odd callback part coroutine promise improves php null file yield watcherwait job thisindexergetjobfilepath foreach jobgenerator file yield new delayed refactor code yield promise modified file whilst initially thought would quite difficult didnt take long watcher async corouting build queue modified file subsequently yieled wait called watcher file pause coroutine millisecond try consequence easier integrate library amp project downside mean coupling amp public api seeing package called ampfswatch thats acceptable