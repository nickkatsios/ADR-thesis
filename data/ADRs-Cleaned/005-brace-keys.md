adr brace key acknowledged may unknown weakness elliptic curve cryptography quantum computer may arrive earlier predicted reason propose additional mechanism protecting transcript postconversation decryption otrv take advantage quantum resistant algorithm key described provide kind postquantum confidentiality faulttolerant quantum computer break edgoldilocks key take year beyond point break described bit diffiehellman key proposal believe protect transcript postconversation decryption mixing another key obtained diffiehellman exchange key material additional key called brace key document specifies brace key mix ecdh shared secret deriving new mixed shared secret algorithm ratcheting deriving brace key document change way root key derived double ratchet algorithm first bit key agreement take place dake traditional diffiehellman key exchange considered two ratchetingderiving brace key obtain brace key function requires party contribute computation time new mixed shared secret derived obtain brace key function require party contribute computation every time derivation brace key obtained key derivation function kdf seeded last key propose chose second therefore otrv algorithm kdh brace key key added kdf derive new mixed shared secret brace key produced function key derivation function first method produce bit public key later input key derivation function kdfusagethirdbracekey kdh second method produce byte key result key derivation function take input previous brace key kdfusagebracekey bracekey key bit security level according table comparable strength nist recommendation key management page generatedh function generatedh generates function dhai given secret key public key generates shared secret value kdh key derivation function shakekdh given bit shared secret value kdh shake generates byte digest bracekey key derivation function shakebracekey given bracekey shake generates byte digest new bracekey consideration deriving bit public key increase time take exchange message mitigate key wont generated every time chain key derived instead key computed function every third ratchet interim key derived previous bracekey generating new key new public key sent every message ratchet order allow transmission even one message dropped brace key mixed ecdh key produce mixed shared secret implementation alices keypair bob keypair every mixed shared secret derivation requires ecdh key brace key purpose explanation discus brace key number ratchet performing new computation variable set interim root key derivation brace key derived shake previous brace key seed configured equal assume message sent alice bob dake ratchet alice bob generates new public key secret key derives new shared secret bob public key received previous ratchet kdh dhb derives new brace key kdh bracekey kdfusagebracekey kdh mix brace key ecdh shared secret create mixed shared secret kdfusagesharedsecret kecdh bracekey generates root key sending chain key root key rootkey mixed shared secret rootkey kdfusagerootkey rootkey chainkeys kdfusagechainkey rootkey encrypts data message message key derived chainkeys sends datamessage attached generates new public key secret key derives new shared secret alices public key received data message kdh dha derives new brace key kdh bracekey kdfusagebracekey kdh mix brace key ecdh shared secret create shared secret kdfusagesharedsecret kecdh bracekey generates root receiving chain key root key rootkey mixed shared secret rootkey kdfusagerootkey rootkey chainkeyr kdfusagechainkey rootkey decrypts received message message key derived chainkeyr derives new brace key one derived previously bracekey kdfusagebracekey bracekey generates new ecdh key alices ecdh public key received datamessage create ecdh shared secret kecdh mix brace key kecdh create mixed shared secret kdfusagesharedsecret kecdh bracekey generates root sending chain key root key rootkey mixed shared secret rootkey kdfusagerootkey rootkey chainkeys kdfusagechainkey rootkey encrypts data message message key derived chainkeys sends datamessage alice bob sends first message ratchet first reply new ratchet happens every time send data message receiving one side receive data message advertises new ecdh public key party state variable exists keep track last time key generated increased every time ratchet happens compute new brace key computation bracekeyi kdfusagethirdbracekey dhourdhsecret theirdhpublic send new bracekeys public key ourdhpublic party key computation otherwise derive new brace key kdfusagebracekey bracekey alice bob send followup message new public key generated sent first message ratchet follow message ratchet also advertise public key case arrive outoforder way dropped alice bob receive first message ratchet check new public key attached message reject message otherwise compute new brace key new computation bracekeyi kdfusagethirdbracekey dhourdhsecret theirdhpublic bracekeyi calculate mixed shared secret diagram pattern computation key derivation conversation diagram describes public key sent alice bob compute bracekey kdf new computation party share knowledge bracekey established immediately dake given alices keypair bob keypair alice sends first message alice ratchetid publickey bob bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfdha bracekey kdfdhb bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfdha bracekey kdfdhb bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfbracekey bracekey kdfdha bracekey kdfdhb performance computation gab take second generator exponent bit long intel core ghz operation repeat time time per operation computesharedsecret msop keygeneration msop weve decide bit key produced function take argument party exponent advertised data message produce brace key kdf kdfusagebracekey bracekey previous brace key produce new one function run every time small number particular key compromised maximum ratchet mean maximum ratchet brace key key derived brace key sender receiver side group key one assigned ietf paper rfc prime integerpartof hex value ffffffff ffffffff cfdaa ccb dccd acc bbea edd efb cdab bad fed eec fce aedb bffcb fbed eebfb afa aef cbfe ecebd ccb abf cda fdcff dcaad abc cac eceb eec ecaf bcdf fcc debcbf eaae aaacd add aab dfcba ecfb dbefa aea dcd aeec abfaec dbd ece ceed adeeb fffa eca bbe adc bade efa eab dbbfc efde aadca ffffffff ffffffff generator consequence bit function produce brace key increase size data message byte extra key material increased size may cause transport protocol fragment message reference barker recommendation key management nist special publication available httpnvlpubsnistgovnistpubsspecialpublicationsnistspptrpdf kojo modular exponential modp diffiehellman group internet key exchange ike internet engineering task force rfc available httpswwwietforgrfcrfctxt