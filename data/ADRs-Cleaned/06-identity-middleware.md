identity middleware identity middleware responsible controlling access mma route mma mandatory signin route requiring user signed access route identity middleware responsible validating user oauth token performing authorization code flow necessary route mostly connected help centre optional signin route route identity middleware attempt validate user oauth token active okta session otherwise allow user access route signedout state middleware flow mermaid flowchart startstart publicroutepublic route publicroute signoutcookiesetguso cookie set signoutcookieset yes clearcookiesclear oauth cooky clearcookies performauthmandatoryperform authorization code flow nmandatory endpoint signoutcookieset tokensvalidoauth idapincookies locally valid tokensvalid yes needserversideneed serverside validation needserverside yes serversidevalidserverside validation valid needserverside setlocalstateset reslocalsidentity serversidevalid yes setlocalstate serversidevalid performauthmandatory setlocalstate nextnext tokensvalid performauthmandatory publicroute yes signoutcookiesetguso cookie set signoutcookieset yes clearcookiesclear oauth cooky clearcookies next signoutcookieset tokensvalidoauth idapincookies locally valid tokensvalid yes setlocalstate tokensvalid guusetgugu cookie set guuset next guuset yes performauthoptionalperform authorization code flow noptional endpoint