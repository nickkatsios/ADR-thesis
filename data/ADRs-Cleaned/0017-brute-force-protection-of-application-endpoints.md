brute force protection application endpoint adr detail mitigation brute force attack certain endpoint type protection scope mitigate brute force attack certain endpoint application currently actor login one time passcode adding lpa viewer code viewing lpa brute force defined multiple failed attempt carry action protecting kind attack problem two part reliable identification user recording attempt user protected endpoint identification bare minimum information identify user originating address without issue spoofed likely user behind nat proxy layer likely case corporate user couple browser sent header offer extra user identifying information accept dnt useragent etc hashing function generate uniquely identify user identify user hash calculated incoming associated header track identity session guard changing header within session attempt tracking cache service aws elasticache track failure attempt three endpoint defined perendpoint moving window ratelimit reduce brute force impact individually configurable term window size request limit consequence introduce new piece technology stack redis based elasticache identification user tricky issue prone abuse refinement approach made