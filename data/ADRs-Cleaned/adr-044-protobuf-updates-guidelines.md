adr guideline updating protobuf definition changelog initial draft add since comment new field remove rule new msg proto version draft abstract adr provides guideline recommended practice updating protobuf definition guideline targeting module developer cosmos sdk maintains set protobuf definition important correctly design protobuf definition avoid breaking change within version reason break tooling including indexer explorer wallet thirdparty integration making change protobuf definition cosmos sdk currently follows bufs recommendation noticed however bufs recommendation might still result breaking change sdk case example adding field msg adding field protobuf specbreaking operation however adding new field msg unknown field rejection throw error sending new msg older node marking field reserved protobuf proposes reserved keyword removing field without bump package version however client backwards compatibility broken protobuf doesnt generate anything reserved field see detail issue moreover module developer often face question around protobuf definition rename field deprecate field adr aim answer question providing clear guideline allowed update protobuf definition decide keep bufs recommendation following exception unaryrpc cosmos sdk currently support streaming rpcs commentfield cosmos sdk allows field comment servicesuffix query msg service naming convention doesnt service suffix packageversionsuffix package cosmoscryptoed dont version suffix rpcrequeststandardname request msg service dont request suffix keep backwards compatibility top bufs recommendation add following guideline specific cosmos sdk updating protobuf definition without bumping version module developer may add new protobuf definition module developer may add new message new service new rpc endpoint new field existing message recommendation follows protobuf specification added document clarity sdk requires one additional change sdk requires protobuf comment new addition contain one line following format protobuf since cosmossdk version version version denotes minor patch version field available greatly help client library optionally reflection custom code generation showhide field depending targeted node version example following comment valid protobuf since cosmossdk since cosmossdk following one valid protobuf since cosmossdk since cosmossdk since cosmossdk since cosmos sdk field may marked deprecated node may implement protocolbreaking change handling field protobuf support deprecated field may field including msg field node handle protobuf message nonempty deprecated field node may change behavior upon processing even protocolbreaking way possible node must handle backwards compatibility without breaking consensus unless increment proto version example cosmos sdk update contained two protobufbreaking change listed instead bumping package version vbeta sdk team decided follow guideline reverting breaking change marking change deprecated modifying node implementation processing message deprecated field specifically cosmos sdk recently removed support timebased software upgrade time field marked deprecated cosmosupgradevbetaplan moreover node reject proposal containing upgrade plan whose time field nonempty cosmos sdk support governance split vote querying vote returned cosmosgovvbetavote message field vote deprecated favor field allowing multiple vote whenever possible sdk still populates deprecated field lenoptions optionsweight field must renamed whereas official protobuf recommendation prohibit renaming field break protobuf binary representation sdk explicitly forbids renaming field protobuf structs main reason choice avoid introducing breaking change client often rely hardcoded field generated type moreover renaming field lead clientbreaking json representation protobuf definition rest endpoint cli incrementing protobuf package version todo architecture review topic bumping version frequency bumping version cosmos sdk support version vbeta two folder cosmos sdk handler version mention adr protobuf naming consequence section describes resulting applying consequence listed positive one particular may positive negative neutral consequence affect team project future backwards compatibility adrs introduce backwards incompatibility must include section describing incompatibility severity adr must explain author proposes deal incompatibility adr submission without sufficient backwards compatibility treatise may rejected outright positive pain tool developer compatibility ecosystem negative negative consequence neutral rigor protobuf review discussion adr still draft stage incrementing protobuf package version filled make correctly test case optional test case implementation mandatory adrs affecting consensus change adrs choose include link test case applicable reference release proto definition address vbeta proto breaking change