store payment data firestore deciders ben bangert barry chen bianca danforth danny coates orchard problem statement payment data stripe paypal apple google iap handled individual document typically access different portion different time addition schema occasionally change api update stripe paypal api limit mean typically duplicatecache data retrieve moment cache data redis mostly work restricts ability run query across payment data set without pulling bigquery making substantial amount stripepaypal request handle iap store apple receipt google subscription object organized fxa user belong theyre arbitrary json document also copied bigquery etl job futureproof payment data storage flexibility needed store stripepaypal payment data data store etl capability driver engineering resource arbitrary json document querying ability ease loading data etl job capable storing arbitrary json data integration stripe payment system considered google firestore mysql redis outcome google firestore weve firestore eventbroker rich api extension overlap requirement reduces engineering operation resource pro con google firestore firestore json document oriented datastore store document collection table also ability nest collection document single user document could collection payment document defined schema arbitrary json document stored firestore eventbroker along streaming watch capability immediate update cached data dispatch event stripe built multiple extension firestore keep invoice customer data sync google also built variety extension firestore including bigquery sync extension would handle etl pro already firestore integrated fxaeventbroker operationally simple google host manages firestore extension supported stripe bigquery extension handle requirement comprehensive querying capability portion json document document nesting organization payment data con may still cache commonly accessed data redis reduce firestore spend increase database authserver talk mysql firefox account mysql data shortlived recreatable data stored redis oauth token related could store payment data mysql rest user data mysql support json document limited query capability mysql additional json functionality partial document update would required pro already mysql integrated fxaauthserver additional setup con cant query arbitrary path json document arent mysql complicates json document manipulation redis firefox account redis heavily caching short term data storage fast caching variety json document already pro already integrated authserver fast little additional costresource overhead con arent redis cluster mode ensures data durability query ability portion document stored string