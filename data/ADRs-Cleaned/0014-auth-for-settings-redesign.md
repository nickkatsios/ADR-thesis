authentication setting redesign superseded adr deciders orchard lauren zugai ben bangert ryan kelly issue httpsjiramozillacombrowsefxa problem statement setting redesign app query mutate protected user data existing setting app hosted contentserver require form authentication authorization manage data driver smooth security development velocity ease integration considered authenticate via oauth authserver apis authenticate via oauth directly reuse existing sessiontoken contentserver authserver apis implement login session outcome chosen authenticate via oauth authserver apis requires minimal change existing authserver implementation infrastructure relies authentication mechanism relatively wellknown security property positive consequence oauth access token mechanism better suited purpose novel scheme share session token credential new setting redesign app existing authserver apis minimal modification accept scoped oauth access token constrain novelty project redesigned reimplemented setting negative consequence modify auth strategy authserver apis taking care affect existing usage production setting app dont entirely greenfield project could bit drag rediscovering lesson learned existing code also drag pro con authenticate via oauth authserver apis would like someday deprecate session token mechanism altogether could start pro security property oauth authn authz known entirely novel authserver apis reused small change neutral graphql server proxy authserver apis con apis authserver auth strategy change accept oauth token may initially require hack similar paymentsserver pregenerated access token passed along authenticate via oauth directly would like someday deprecate session token mechanism altogether would also like modernize around sort thing authserver could start pro security property oauth authn authz known entirely novel reuse least oauth apis authserver validate token stored client neutral graphql server implemented scratch directly con auth flow require user confirm permission skipping authserver requires reinventing many thing new implementation require security review authserver reimplementations reuse existing sessiontoken contentserver authserver apis setting redesign frontend hosted accountsfirefoxcombetasettings per fxa mean access credential original setting frontend contentserver pro done seamless user visit new setting without confirmation neutral graphql server proxy authserver apis con hawk request signing session token credential authentication passing credential frontend gql backend essentially defeat purpose hawk since scheme part meant minimize transmission credential network implement login session could make complete break everything database start fresh pro none neutral graphql server implemented scratch directly con user must login separately cannot piggyback atop existing fxa login novel security property new login session system maintain storage persistent session database redistribution skipping authserver requires reinventing many authserver thing