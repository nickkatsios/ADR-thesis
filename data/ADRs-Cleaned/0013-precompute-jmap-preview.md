precompute jmap email preview jmap message handy preview property displaying first character meaningful test message property often displayed message listing jmap client thus queried lot currently get preview james retrieves full message body parse mime parser remove html keep meaningful text precompute message preview mailboxlistener compute preview store messagepreviewstore cassandra memory implementation preview precomputed message consider preview property metadata preview precomputed compute preview message save result later provide webadmin task allowing rebuild projection computing storing messagepreviewstore idempotent task run live without concurrency problem performance test run order evaluate improvement consequence given following scenario played user per hour constant rate authenticate list mailbox list message one mailbox get time property expected fast fetch jmap went failure timeout rate change almost failure mean time getmessages went time improvment operation time improvment metric make sense initial simulation exceeded gatling performance measuring tool timeout percentile proposal entire scenario changeset significantly increase jmap performance reference httpsjmapioserverhtmlemails jmap client guice state preview quick retrieve similar taken fastmail httpsfastmailblogdecputtingthefastinfastmailloadingyourmailboxquickly jira