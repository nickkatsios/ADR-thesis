api sending email problem statement achieve api coverage handle email api considered event event allow trigger handler operation completed syliusapibundleeventordercompleted event triggered handle srcsyliusbundleapibundleeventhandlerordercompletedhandlerphp command srcsyliusbundleapibundlecommandsendorderconfirmationphp dispatched trigger command handler srcsyliusbundleapibundlecommandhandlersendorderconfirmationhandlerphp sendorderconfirmationhandler sending email based destination case orderconfirmation thisemailsendersend emailsorderconfirmationresent ordergetcustomergetemail order order channel ordergetchannel localecode ordergetlocalecode good easy integrate logic initial command succeed good easy trigger operation several time good easier handle mailing server down gracefully bad add lot abstraction hard understand direct email call srcsyliusbundleapibundlecommandhandlercheckoutcompleteorderhandlerphp create direct call email php thisemailmanagersendconfirmationemailcart good easy understand bad generate lot problem future sent asynchronously email manager class changed handle somehow hard implement outcome chosen event allows send email event command handler thanks queue message async transport