template switch dynamic static construct want build framework component work dynamic static memory allocation scheme rather duplicating implementation template metaprogramming single structure support static dynamic memory allocation class templated size parameter size evaluated determine underlying data structure size equal dynamic memory assumed otherwise static memory allocation consequence module become much complicated understand rely template metaprogramming many developer leery template hard time understanding code