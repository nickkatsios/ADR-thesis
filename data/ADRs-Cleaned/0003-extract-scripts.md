extract script dockerfile run step dockerfiles make provision extracting duplication step unless rendered template similar run step multiply across different file run step also allow logic encapsulation promote long chain command due necessity producing single layer run step testable isolation rerunnable inside image debugging extract long run step sequence step bash script script root place rootscripts consequence dockerfiles grow line least run step every time single script modified copy script step invalidate reexecuted