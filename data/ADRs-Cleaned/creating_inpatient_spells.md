defining inpatient spell hospital spell defined period care one hospital provider trust admission discharge transfer spell made one finished consultant episode fce continuous period care one consultant spell consist one episode one row apc dataset spell contain multiple episode patient multiple episode andor multiple spell episode considered valid creating spell finished epistat equal following missing encryptedhesid admidatefilled procode epikey epistart epiend episode within spell encryptedhesid procode within group encryptedhesid procode combination row ordered epistart epiend epiorder transit epikey episode considered part spell previous episode one following true admidatefilled current episode previous episode epistart current episode previous episode method discharge previuos episode tranfer dismeth episode start epistart current episode match episode end previous episode epiend two derived variable correspondong spell information newspell true episode mark beginning new spell false otherwise spellid spell identifier unique combination encryptedhesid new spell table apc created containing one row per spell per unique combination encrypedhesid spellid table populated information derived first episode within spell excluding following column epiend disdate disdest dismeth disreadydate epikey epidur epiorder epistat mainspef spelbgin speldur spelend tretspef consulttype encryptedhesidmissingprocodemissing transit admidatemissing epidurcalc epibad epivalid newspell rowcount subdate suscorehrg sushrg sushrgvers susrecid information derived last episode within spell epiorder maxepiorder including following column disdate disdest dismeth disreadydate epikey renamed epikeydis epiend spell contains one episode first last episode implemented see spellsr consequence newspell spellid set episode valid