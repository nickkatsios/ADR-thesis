regular php session storing last seen data make referral notification work needed way store lastseen value whole session updated every hour middleware cant directly user model database would cause never show notification last seen updated even get chance show page laravel session didnt work regular php session worked implemented lastseen middleware check prevlastseen session variable missing update lastseen value exists dont change later userhasnewreferrals check determine right cutoff time either day ago distant lastseen value consequence always start php session including test doesnt intefere anything