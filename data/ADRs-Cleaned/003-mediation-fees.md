mediation fee calculation message format proposed deciders augusto dominik karl paul problem statement mediating node demand fee mediation service fee incentivize running raiden node also help balancing network done reducing mediation fee payment leave channel balanced state payment possibly even negative fee driver balancing network incentivized raiden node act selfishly mediation fee flexible enough accommodate arbitrary business model party operation raiden node considered fixed fee proportional fee flat prop amount fixed fee proportional fee imbalance fee based fixed imbalance measure fixed fee proportional fee submitting point function describing imbalance fee submitting point single function dependent payment amount includes fee outcome chosen important addition see would sufficient short term incentivize rebalancing work objective balance measure could found valid across business model user interest would work require sending changed fee schedule every transfer mediation since information broadcast thats nonnegligible amount traffic positive consequence adaptable different business model outgoing channel rebalanced fully exhausting channel punished strongly moving wrong direction fee schedule changed node strategy change onchain capacity change via deposit withdraw fee component optional node flat fee submit complicated function negative consequence comparatively complex detailed analysis one important detail fee calculated channel mediation payment sent also channel payment received without node could incentivize receiving certain channel important rebalancing sending right channel see next section detailed example total mediation fee node mftotal mfinchannel mfoutchannel channel mfchannel flatfee proportionalfee amount ipcafter ipcbefore imbalance penalty function cbeforeafter channel capacity payment channel capacity node free capacity reported pfs pfscapacityupdate message function function describes much node willing pay absolute valueswad move away undesirable channel capacity node prefers channel capacity total capacity channel could mediate token direction function might look like dip ipcafter ipcbefore xxxx amount capacity node currently capacity asked mediate payment token coming channel get desired position capacity compensate demand imbalance fee dip ipcafter ipcbefore situation reversed capacity would absolute value would time would negative thus incentivize moving towards preferred state viewing channel balance way imbalance fee zero sum game long term token earned going bad state spent moving good state later mediating node demand mediation fee initiator target could theoretically benefit taken account routing aspect left avoid additional complexity apply fee incoming channel first glance calculating fee incoming channel make sense since mediating node sends money outgoing channel taking part mediation modify channel choice incoming channel relevant mediating node demonstrate cant reliably influence balancing channel apply fee outgoing channel let look one example mediating node three channel channel nearly exhausted channel free capacity token left token deposited channel node want similar amount free capacity channel mediation opportunity achieve must receive token channel desirable transfer point view mediating node undesirable transfer fromto incentivize rebalancing node could reduce fee channel negative value might lead mediating transfer intended problem visible table changing fee outgoing channel incentivize transfer single column desirable transfer single row meaning must incentivize usage incoming channel economic aspect model mediation fee split three part flat fee meant represent base cost handling payment even small payment amount profitable mediate proportional fee large payment lock token payment progress compensate operator receive larger fee large payment imbalance fee direction payment specific channel relevant operator payment might exhaust channel capacity prevent future profitable mediation others could facilitate future mediation due operator compensated willing compensate initiator respectively side effect whole network get balanced state three part roughly map operating cost capital cost opportunity cost flexible shape function allows encode many different operator intention channel solely pay free capacity always desired capacity gained mediating reverse direction welcome case function could look like xxx xxx capacity expect small payment mainly want stay away totally exhausting channel either direction exact capacity matter function would large mostly flat part middle xxxxxxxxxxxxxxx capacity message format three mediation fee component sent separately component optional assumed zero cost included message component needed future could added fashion message format still defined detail payload look roughly like json flat deal float value anyway due interpolation proportional factor transfer amount partspermillion imbalancepenalty imbalance penalty function sent list function point interpolated linearly build function value outside defined range considered impossible mediate