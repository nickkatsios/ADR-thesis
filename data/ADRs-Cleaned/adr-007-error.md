adr error management changelog initial proposal document describes reason behind switch anomaly error handling flexerror crate developed inhouse problem statement keep thing brief look issue error handling specific example relayersrcerrorrs rust pub type error anomalyerror derivethiserrorerror pub enum kind errorgrpc error grpc impl kind pub contextself source impl anomalycontext contextnewself somesourceinto design meant separate two concern metadata error captured kind trace error occurred captured anomalycontext type error defined anomalyerrorkind newtype wrapper boxanomalycontextkind issue original design anomaly error source type erased turned boxdyn stderrorerror making difficult recover metadata information original error kindcontext method allows error type error source making difficult statically analyze suberror kind error source demonstrate design issue specific case rust pub unbondingperiodself result let mut client self blockonqueryclientconnectselfgrpcaddrclone maperre kindgrpccontexte let request requestnewqueryparamsrequest let response self blockonclientparamsrequest maperre kindgrpccontexte without help ide would challenging figure first kindgrpccontext tonicstatus error source type second error source type tonictransporterror mixing tonicstatus tonictransporterror error source critical specific case however would case want error source information determine whether error recoverable instance let say want implement custom retry logic error source stdioerror easy way distinguished error variant kindgrpc caused stdioerror proposed design better design define error construction function explicit error source proposed design follows rust pub struct errorpub errordetail pub eyrereport pub enum errordetail grpcstatus tonicstatus grpctransport impl error pub grpcstatusstatus tonicstatus error let detail errordetailgrpcstatus errordetail eyremsgdetail pub grpctransportsource tonictransporterror error let detail errordetailgrpctransport let trace eyrenewsourcewraperrdetail errordetail trace thing addressed design eyrereport type error tracer trace error source together additional information backtrace depending error source type want different strategy trace error example may care metadata inside tonictransporterror discard data tracing eyre define error constructor function handle error source different strategy function construct errordetail eyrereport value wrap error tuple general error source defined external library little control type defined different way handle multiple error type defined crate want special way handle propagation error example consider linkerror type error defined earlier error source rust crateerrorerror relayererror errordetail relayererrordetail pub struct linkerrorlinkerrordetail eyrereport pub enum linkerrordetail relayer source relayererrordetail impl linkerror pub relayererrorsourcedetail trace relayererror linkerror let detail linkerrordetailrelayersourcedetail linkerrordetail tracewraperrdetail propagate error detail linkerrordetail recover additional detail later furthermore extract eyrereport error source add additional information construct linkerror flexerror proposed design lot boilerplate required properly define error type reduce boilerplate developed flexerror defineerror macro make straightforward implement error type dsl syntax error type instead defined rust flexerrordefineerror traceerror defineerror error grpcstatus grpcstatus formatgrpc call return error estatus grpctransport traceerror error underlying transport making grpc call aside syntactic sugar provided defineerror macro flexerror also allows error tracer implementation switched based cargo feature flag set flexerror crate example switch eyre tracer anyhow tracer disabling flexerroreyretracer enabling flexerroranyhowtracer feature error tracer feature flexerrorstd feature disabled simple flexerrorstringtracer tracing error stringtracer provide additional information back trace useful supporting nostd standard construct stderrorerror error backtrace available full documentation flexerror available docsrs merged consequence error definition ibcrs project defined flexerror crate positive fine grained error handling flexible error tracing nostd support negative take time learn dsl manage different error source compile error arise inside macro may difficult debug ide provides limited integration code inside macro neutral error variant defined errordetailerrorvariant convention error constructor function defined errorerrorvariant convention reference flexerror define error issue relayer error handling specification issue tracking issue nostd support