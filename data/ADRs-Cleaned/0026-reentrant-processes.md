reentrantprocesses elixir provides high level fault tolerance quick restarts failed process code written properly take advantage restart capability work queue one solution always feasible iterating queueing thousand task longrunning operation avoid writing longrunning iterative operation especially change data loop rather single atomic initialization task record task done way track completion genserver genstage handle task mark done atomic transactional piece pseudocode pattern init onetime start transaction initialize task ticket commit transaction process periodic batch load pending task ticket mark batch ticket processing iterate batch ticket start transaction process one ticket mark ticket complete commit transaction sweep periodic expired find processing task ticket older reasonable timeout mark expired pending single update consequence task become resilient able survive processserver termination crash restart replacement code becomes complicated loop broken initprocesssweep stage