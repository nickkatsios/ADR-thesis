cart guest logged customer problem statement cart processing one key aspect sylius turned vulnerability possible anonymous user override cart logged customer email entering email addressing step customer email assigned cart simple way distinguish cart created guest logged user question distinguish cart solve vulnerability driver provided solution solve initial problem overriding cart logged customer anonymous user break backward compatibility code business behaviour considered forcing logging checkout good solves initial problem bad change current expected behaviour checkout bad break backward compatibility business perspective changing priority cart good solves initial problem bad solve case logged customer cart bad change current expected behaviour keeping cart logging bad break backward compatibility business perspective introducing flag order entity mark order created guest adding flag order entity allows distinguish cart created guest logged customer mark cart soon possible solve case initial problem flag set syliuscomponentcorecartcontextshopbasedcartcontext customer logged user also set cart definitely proper service operation however consistent current approach sylius setting value logging would enough doesnt resolve situation already logged user creates cart similar setting flag addressing step doesnt resolve problem cart logged user marked late addressing cart couldnt distinguished belongs good solves initial problem good break backward compatibility good additional feature future bad requires set flag syliuscomponentcorecartcontextshopbasedcartcontext outcome chosen introducing flag order entity mark order created guest straightforward solution resolve initial problem introduce break solution could additional feature future reference approach changing priority chosen approach introducing flag