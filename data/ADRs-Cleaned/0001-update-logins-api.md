update logins api technical story problem statement longer want depend sqlcipher want sqlite directly build complexity concern long term future rust binding encryption approach taken sqlcipher mean practice entire database decrypted startup even logins functionality interacted defeating benefit encrypted database perfield encryption autofill planning replicate logins separate storage encryption logic limiting storage layer management encrypted data applying approach logins break existing validation deduping code way implement perfield encryption supporting validation deduping behavior driver addressing previously identified deficiency logins api breaking api encryption work continuing support existing logins validation deduping logic avoiding implementation new security approach may require additional time security resource establishing standard encryption approach across component considered reduce api function require encryption key pas key remaining function keep general shape api place app pas encryption key time unlock api relock time api entirety available unlocked outcome chosen reduce api function require encryption key pas key remaining function require security review similar approach established codebase pro con reduce api function require encryption key pas key remaining function description currently logins api function would require perfield encryption key add update getall getbybasedomain getbyid checkvalidwithnodupes potentialdupesignoringusername importmultiple note function related sync omitted assumed access decrypted data getall getbybasedomain getbyid function require encryption key call validate fixup logic want return logins decrypted data proposed change combine add update function new addorupdate function allow removal consumer code distinguishes login record created updated note function encryption key fixup deduping logic continued support accurate population timepasswordchanged field pas perfield encryption key importmultiple function function removed fennec fenix migration period end remove potentialdupesignoringusername checkvalidwithnodupes api neither function called firefox android component provide validation deduping logins added updated eliminate externalize function replicating logic new addorupdate function create decryptandfixuplogin function decrypts login performs validate fixup logic eliminate getall getbybasedomain getbyid api function perform fixup logic making change reduce api function requiring encryption key following addorupdate decryptandfixuplogin importmultiple pro improves logins api consumer combining addupdate functionality see detail remove redundant validation deduping logic consumer code encryption model autofill consistency approach con requires consumer code encrypt login field pas encryption key calling either addorupdate importmultiple implement different key management approach description unlike first publicly exposed login api would handle decrypted login record encryption internal work always key attempt api fail login record encrypted decrypted key available proposed change combine add update function addorupdate remove potentialdupesignoringusername checkvalidwithnodupes api pro prevents consumer encrypt decrypt login record maintains current fixup validation approach improves logins api consumer combining addupdate functionality remove redundant validation deduping logic consumer code con make responsible securing encryption key likely require security review link logins validate fixup call tree