layout default title adr navorder permalink record containerization sdr application drafted deciders vivian wong julian morley infrastructure team operation team problem statement currently sdr infrastructure managed puppet sdr application deployed capistrano approach number shortcoming result sdr instability requires significant time infrastructure operation team troubleshooting also hinders agility provisioning new server take time requires manual intervention shortcoming include server inconsistency server vary number way environment dorservices app stage prod within environment dorservicesappa dorservicesappb variation necessary connected different storage others unnecessary problematic different version ruby installed different way different version library etc problematic variation due manual intervention server different puppet specification kept server must manually kept sync past several year also complicated server migration different environment running different development inconsistency local development environment differ deployment environment significant degree inconsistency lead surprise moving application deployment environment course environment cannot identical difference easier detect issue development time puppet capistrano mismatch relying puppet capistrano make activity like upgrading ruby difficult requires coordinating change location performing manual operation much manual intervention overall provisioning deploying maintaining application require much manual intervention infrastructure operation team canonical specification application requirement application requirement library port storage mount must gleaned multiple source multiple puppet configuration devopsdocs repository readmes sharedconfigs etc make server provisioning maintenance error prone proposed containerization particular docker image deployment strategy sdr application variety approach containerization described considered driver consistent deployment sdr application provisioning server separation responsibility operation handle provisioning server infrastructure handle deployment application maintain current approach realistic technical requirement given current priority staffing funding level considered docker image running kubernetes docker image running puppetmanaged server image built server docker image running puppetmanaged server image pulled docker repository docker hub note possible take incremental approach viz start docker image running puppetmanaged server image built server move image pulled docker repository move puppetmanaged server kubernetes outcome determined pro con docker image running kubernetes pro kubernetes provides advanced provisioning feature autoscaling pro kubernetes provides ability quickly spinup teardown testing environment con kubernetes extremely complicated con adopting kubernetes project likely time sdr would candidate docker image running puppetmanaged server image built server approach puppet would manage server running docker puppet would longer handle ruby library etc would continue manage storage firewall port provide secret via environment variable docker compose would run one container server example server might run apache container shibboleth rail container web application server might run multiple instance sidekiq worker container similar current server running multiple sidekiq worker process minimal orchestration requires good fit docker compose also providing ability environment specific configuration together docker docker compose provide clear canonical specification application requirement general container running server would match server current responsibility example argoprod would run argo web application sidekiq worker wouldnt also run dor service app puppet managed storage would shared docker container addition capistrano would deploy application leverage existing tooling deploying code configuration including handling testing branch however instead starting process server capistrano build docker image startstop docker container running image pro reuses existing puppetmanaged infrastructure pro reuses existing tooling deploying code configuration secret management pro requires minimal change development deployment process con guarantee identical container running different server docker image running puppetmanaged server image pulled docker repository similar approach except code deployed server docker image built server instead docker image built elsewhere developer machine circleci pulled server pro guarantee identical container running different server pro consistent prevailing industry practice con requires change development process handle automation build image con requires new undetermined approach configuration secret management preferable infrastructure team able manage configuration without operation team involvement similar existing sharedconfigs approach scope continuous deployment goal adr replace sharedconfigs better secret management may make sense consider adjacent work containerization core service database redis rabbitmq consideration open question shibboleth run container uit firewall load balancer problematic container would cron job handled security best practice process followed container