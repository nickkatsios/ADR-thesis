concurrency proposed loading holding data mongodb largely cpu bound optimal performance loading data want multiple process thread loading data simultaneously possibility cluster split merge loading data hathitrust item concordance data loading data parallel suffers number concurrency hazard particular possible one process attempt update document deleted another process deleted reclustered another process mongodb support proactive locking individual document support transaction detect conflict update document involved multiple simultaneous transaction wrap operation suffers potential write conflict retryable transaction ensure update operation modify expected number document retry operation test handling concurrency hazard consequence underlying mongodb update operation return information number modified document activerecordstyle mongoid interface expose information write operation therefore must call mongodb operation directly rather mongoid interface involves adding subdocuments extra work necessary ensure association parent document subdocument reflected mongoid increase overall complexity system current configuration mongodb allows speed loading single thread performance improvement may necessary incremental load difference able reload data system day several week implementing retryable transaction also increase overall resilience system even absence routine concurrency still useful verify update completed expected retry testing concurrent operation relying specific ordering difficult approach concurrencyspecrb take synchronize operation thread wait presence specific file file system continuing note even transaction enabled report analysis run data loaded result consistent