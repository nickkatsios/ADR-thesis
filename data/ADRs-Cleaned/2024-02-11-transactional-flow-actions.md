title introduce transactional flow action area core tag flow flowaction flow action want interact database transactional manner handle starting committing transaction problem committing transaction error caught ignored flow dispatcher vague error message logged flow continue execute problematic transaction already started flow executed connection configured without save point default shopware nested commit fails flow action connection marked rollback outer transaction attempt commit calling code unaware previous inner commit failure thus also fail introduce new marker interface shopwarecorecontentflowdispatchingtransactionalaction flow action implement flow executor wrap action database transaction implement interface php class setorderstateaction extends flowaction implement delayableaction public function handleflowstorableflow flow void thisconnectionbegintransaction stuff try thisconnectioncommit catch throwable php class setorderstateaction extends flowaction implement delayableaction transactionalaction public function handleflowstorableflow flow void stuff wrapped transaction also force flow executor rollback transaction throwing instance shopwarecorecontentflowdispatchingtransactionfailedexception static method create exception another one php class setorderstateaction extends flowaction implement delayableaction transactionalaction public function handleflowstorableflow flow void try search record entity thisrepofind catch notfoundexception throw transactionfailedexceptionbecausee transaction rollback either following true doctrine throw instance doctrinedbalexception commit action throw instance transactionfailedexception execution another nonhandled exception thrown action execution aid debugging transaction fails error logged also transaction performed inside nested transaction without save point enabled exception rethrown calling code know something went wrong able handle correctly rolling back instead committing instance connection marked rollback consequence developer want create flow run inside database transaction implement interface shopwarecorecontentflowdispatchingtransactionalaction nothing else required transaction commit fails inside nested transaction exception rethrown mean scheduled action executed