websrekubernetessecretspattern secret inconsistently managed across various cluster make hard trace secret come update also increase exposure security issue tool become compromised independently current known secret management includes gitcrypt repos sop apply kubernetes secret direct cluster sealed secret external secret pointing cloud provider secret storage method treat thing secret incorrectly example baking secret docker image directly bad state treat situation urgency correcting pattern soon possible adr goal document describe happy path passing secret kubernetes based application general nonkubernetes secret management scope document cover serverless deployment lambda cicd impacted choice expect look like adopting adr store secret cloud provider secret manager aws secret manager gcp secret manager external secret httpsgithubcomexternalsecretskubernetesexternalsecrets retrieve secret present pod env variable reason storage method preferred cloud secret manager seem best secured tested easiest place store secret external secret connects secret manager present secret method often recommended kubernetes factor app pattern environment variable one nice benefit system reference secret stored source code connection app secret storage explicit secret value source code benefit reducing risk leaking secret accidently currently way secret written cloud secret store terraform writes secret directly secret store secret populated manually operator expect method going forward general expect sresoperators elevated privilege manage secret adr intentionally doesnt include scope devs write new secret update existing one default assumption storage pattern aws secret store follow pattern groupappenvironmentsecretname example mozmeaosnippetsstagedatabaseurl seems make writing aws iam access stanza easy needing rewritten new secret added enough separation prevent accidentally crossing wire want choose one secret storage retrieval method one known good way make operator experience much simpler alternativesalready existing method listed quick note didnt standardize choosing type secret storage mechanism including possibly limited gitcrypt secret repos sop secret directly many manual step get secret prod difficult remove access people left gitcrypt doesnt support removing key reencrypt sealed secret workflow pattern similar externalsecrets keeping therefore doesnt make sense double maintenance burden little extra benefit sealed secret require extra cli tool setup operator computer ever slightly difficult externalsecrets ssm parameter store lambdascodebuilds mostly earlier version secret manager splitting secret two place lead duplication workflow similar maintaining seems suboptimal new system built example hashicorp vault thats entire project choosing buy choice good enough adding secret directly docker image directly source code high priority fix avoiding security informed explicitly bad practice make way easy leak secret world expect cicd pipeline current secret storage try connect secret store one exception cloud native pipeline solution aws codebuild secret manager possible may end duplicating secret general try keep application secret pipeline secret separate pipeline secret manually added right consequence subject prioritization practicality concern migrate secret solution reasonably risky process many application fewer method managing secret ought make easier rotate secret keep etc gatekeeper adding new secret may increase unplanned work team lose secret manager completely rebuilding would long arduous process updating secret include manual step like rotating pod new secret secret update manual intervention update one pod make sure come healthy update rest pod new secret cicd repos including public helm chart reference secret safely without accidentally leaking value