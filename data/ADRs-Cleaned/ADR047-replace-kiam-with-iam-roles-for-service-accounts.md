adr replace kiam iam role service account kiam added gsp cluster order restrict iam role access pod namespacelevel provides two thing care kiam allows individual pod assume iam role without granting pod ability block access instance metadata service kiam achieves running agent every node proxy access instance metadata service aka imds aka kiam server kiam server proxy request real imds iff pod namespace correct annotation introduced kiam awsmanaged equivalent soon deployed kiam cluster aws released iam role service account experienced problem operating kiam kiam breakage would often cause pod unable assume iam role required problem would often fail fairly opaque way immediately clear kiam working expected issue caused downtime point include limited mismatch kiam server agent mtls certificate leading communication failure kiam annotated priorityclassname gspcritical leading agentsservers scheduledstarted since running eks able iam role service account allow pod given restricted access iam role could provide first feature require kiam order iam role service account supported version aws sdk must think thing run support iam role service account grafana whilst upstream looking making grafana work iam role service account doesnt look like available soon order allow grafana continue assume role cloudwatch metric access grant readonly access cloudwatch metric instance level feature rely kiam block direct access imds globalnetworkpolicy make sure correctly annotated pod gspsystem able access imds replace kiam usage equivalent iam role service account grant node readonly access cloudwatch metric grafana continue access cloudwatch data source block access nongspsystem namespaces allow access specifically annotated pod gspsystem namespace remove kiam consequence every node access role readonly access cluster cloudwatch metric however shouldnt accessible pod outside gspsystem