add graphbased pipeline proposed alex black discussed feedback received past konduit serving pipeline essentially stack pipeline step connected next however case require complex structure allowing parallel andor conditional execution pipeline step example case select one model part pipeline split testing test different model different inputsusers one model per selected dynamically per region language time day etc select model might occasionally useful case like sensor fusion image text sound optionalunreliable input parallel branch ensemble model parallelization execute slow step parallel reduce overall pipeline execution time database access network communication etc fallback model rnn provide response otherwise return model fails return adr proposed graphpipeline enable case existing sequencepipeline functionality stack step approach would changed proposal graphpipeline two consideration functionality provide api providing functionality functionality graphpipeline like sequencepipeline single data input single data output allows number thing including embedding graphpipeline within another pipeline sequencepipeline graphpipeline api serving method serving code sequencepipeline graphpipeline user dont internally graphpipeline amount branching parallelism etc single input single output restriction cause usability problem due fact data instance contain number value number keyvalue pair hence anything multidata input design achieved combining splitting data instance proposed provide support directed acyclic graph loop allowed within graph pipeline provide type graph step standard single input single output normal pipelinestep graph switch operation ofn data instance routed one output based criterion value data instance otherwise example case testing switch selects model step merge nto simply copy content input data instance one output data instance nto simply forward first possibly available data instance typically conjunction switch step one branch executed combine function nto arbitrary nto function without input available first addition allowing custom javapython udfs provide small number builtin function ensemble allows weighted averaging etc integer aggregation selection inidx argmaxiniscore timeout condition return get value within otherwise return internally json merge probably implemented special case combinefn really type implementation perspective ofn example case conditional execution branch switchab mergeanyxy output either execute left branch inaxmergeanyout right branch inbymergeanyout combinefn select return prediction model highest probability could also introduce split operation ton splitting single data instance practice simply number simple subset pipeline step parallel example subsetpipelinestep subsetpipelinestep subsetpipelinestep simply copy subset input data keyvalue pair output data instance note routing input output easily supported proposal change inference step needed added later approximated series switch noop pipeline step return empty data merge operation api java goal api make easy passible create graph pipeline exactly unambiguously user expect least two exist functionalstyle api builder style api like dlj computationgraphconfiguration propesd semifunctional api follows java graphbuilder new graphbuilder graphstep input binput standard pipelinestep graphstep mystep inputthenmystep new somepipelinestep always require name merge graphstep merged mystepmergewithmymerged input name optional graphstep banystep step name optional combine combinefn graphstep combined bcombinefn step step name optional switch note exact api tbd essentially functioninteger numoutputs method switchfn graphstep switched bswitchfn mystep construct final graphpipeline pipeline bbuildcombined build method take final output step assuming functionalstyle design there many design mainly related naming method name adding step call followedby inputto probably lot possible method name merging merge mergewith etc method name merge first etc method name combine combine combinefn combinefunction aggregate etc there also concern merge combine close namemeaning confuse people suggestion welcome api python python almost idestical true functional interface pipeline step python graphbuilder input binput stardard pipelinestep mystep inputmystep somepipelinestep merge merged mystepmergewithmymerged input banystep step combinefn combined bcombinefn step step switch switched bswitchsf mystep construct final graphpipeline bcombined bbuildcombined json consider json part public api also want people able write graph step jsonyaml hand sequencepipeline defining step simple user provide arraylist step like json step type step type config value config value type step type config value config value graph pipeline encode extra information graph structure name input graph component pipelinesteps proposal stay close sequnencepipeline representation possible changing following step becomes object map list object key step name add input alias input field within pipeline step pipeline step take single value size list mergeanycombinefn take listarray calling field input input avoid avoid ambiguity clashing name come json serialization time arbitrary configuration class called input user field called input configuration class problem example json graph pipeline pipeline step connected pipeline input one merge step connected input step mystep json step mystep input input type step type config value config value mymerged input input mystep type merge consequence advantage allow build complex type pipeline java python json yaml simple enough user understand type graph step standardpipelinestep switch merge combine pipeline construction there difference term api sequencepipeline graphpipeline exact client api method performing inference type pipeline later easily add embedded pipeline graphpipeline sequencepipeline example disadvantage input input type type issue mentioned earlier multiple nto type could nonobvious first glance user read doc merge combine