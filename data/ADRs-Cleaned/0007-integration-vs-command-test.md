adr test coverage integration command proposed integration test coverage integrationvisolatedcreateorgcommandtestgo overlap command test commandvcreateorgcommandtestgo cause confusion developersdoes test belong integration command adr give guideline order assist developer making want separate black box white box testing black box testing functionality application done integration level white box testing internal structure working application done unit command level integration integration test continue test thing user perspective build around case test output based story parameter style guide example following behavior unbindsecuritygroup story tested integration level describes outputfunctionality unbindsecuritygroup attempt unbind running security group bound space return following security group mygroup bound space myspace lifecycle phase running tip dynamic asgs enabled change automatically apply running staging application otherwise change require app restart running restage staging apply existing application would make beforeeach creates scenario laid story write expectation line output order listed example integrationvglobalunbindsecuritygroupcommandtestgo edited readability golang beforeeachfunc port description somedescription somesecuritygroup helpersnewsecuritygroupsecuritygroupname tcp port description helperscreatesecuritygroupsomesecuritygroup helperscreatespacespacename whenthe space isnt bound security group lifecycle func itsuccessfully run command func session helperscfunbindsecuritygroup securitygroupname orgname spacename eventuallysessionshouldsayunbinding security group org space securitygroupname orgname spacename username eventuallysessionerrshouldsaysecurity group bound space lifecycle phase running securitygroupname spacename eventuallysessionshouldsayok eventuallysessionshouldsaytip dynamic asgs enabled change automatically apply running staging application otherwise change require app restart running restage staging apply existing application eventuallysessionshouldexit command unit unit test want break away perspective want organize test line sight method cover code path see general every err nil corresponding whenactor return error func case test different possible error could returned here example bindsecuritygroup code unit test golang securitygroup warning err cmdactorgetsecuritygroupcmdrequiredargssecuritygroupname cmduidisplaywarningswarnings err nil return err golang itretrieves security group information func expectfakeactorgetsecuritygroupcallcounttoequal securitygroupname fakeactorgetsecuritygroupargsforcall expectsecuritygroupnametoequalcmdrequiredargssecuritygroupname itprints warning func expecttestuierrtosaygetsecuritygroupwarning whenan error encountered getting provided security group func var expectederr error beforeeachfunc expectederr errorsnewget security group error fakeactorgetsecuritygroupreturns resourcessecuritygroup vactionwarningsget security group warning expectederr itreturns error display warning func expectexecuteerrtomatcherrorexpectederr consequence since big change expecting lose coverage increase run time mostly organization purpose plan retrofit existing test adhere adr recommendation noticeable impact time take unit integration test complete integration much lighter weight codebases reference httpstestinggoogleblogcomjustsaynotomoreendtoendtestshtml httpskentcdoddscomblogwritetests