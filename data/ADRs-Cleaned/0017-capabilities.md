capability security adr draft unified security model holochain application zome must able represent enforce security modeling appropriate place push intelligence edge developer must able build granualar specificity revokability access function entry must able distinguish application security model architectural code security model security model application developer build apps security model conductorcore etc ensure zome call arent subject replay attack general also allow zome developer declare create security policy specific holochain variant capability security model holochain dna instance grant revokable cryptographic capability token shared access credential appropriate access credential must access function private data enables single security pattern connecting enduser uis call across zomes within dna bridging call different dna providing selective user dna ability query private entry local chain via sendreceive capability grant get recorded private entry grantor chain validated every zome function call element capabilitygrant capabilitygrant default private entry recorded chain published dht though may case address hash entry serf capability token credential part access request instance look grant address confirm request conforms grant type dna developer manually grant verifygrant api call custom access usecases also done automatically verify zome function call well bridge cross zome call grant attribute asignees list agent grant applies list specified grant assumed transferable possesion token sufficient serf password note anonymous assigned grant mutually exclusive prefilled parameter zomefunction call grant may also specify template parameter value function granted access allows currying type behavior grant grant force function parameter specifc value comment past talked public capability access must signed public access come publishing unassigned token publicly special case agent grant one special case grant agent grant far holochain saying second entry chain dna agentid entry identifies agency publickey owns chain also talked implemented proto along revoking reissue agentid entry capability security model unify capability grant second entry thought superuseradminroot capability indeed granted agent owns chain token agency public key may revoked replace like capability token capabilityrequest capability request structure making request referring particular capability grant request attribute token address capability grant entry committed chain provenance address requester signature request content content exact data content request signed case zome function call request function name function parameter nonce preventing replay attack comment core able three thing capabilityrequst load grant address detect special case grant confirm content match provenance extract data content thats needed purpose actually get function name parameter zomecall process zome function call capability allow developer specify control access zome function calling either exterior call via bridging even crosszome calling latter may seem odd important enabling secure development pattern zome mixins see consequence detail broad overview zome function call outside source would flow capability model agent bundle function name parameter timestamp call request block sign agent private key sends conductor along parameter necessary routing correct instance ever interface conductor creates capabilityrequest structure pass holochain core core load capabilitygrant chain address check validity according grant parameter returning capabilitycheckfailed error calling zome function successfull may also check timestamp call makesure within reasonble window prevent replay attack additionally complete security replay attack necessary may implement additional handshake agent make precall indicating desire make zome call case conductor would pas request core nonce could generated client include call request block note also requires implementing ephemeral store core something thats development path comment agent could webui hold private key holo case could extended conductor electron app former case necessary token grant passed agency owner chain effectively special case agent grant make zome call want otherwise received public token assigned transferable token see consequence calling elementsstructs simple json structure get signed ever component system private key tbd draft structure httpshackmdiocvxmlcffthspncwrfgzgview genesis convention reservedtrait name hcpublic identify function public grant created genesis time made available conductor send uis proxy behalf various usecases webproxy creating provenance public access comment implemented capability bridging tbd consequence exposing token public token add methodconvention agent able access public token generated genesis time capability public token returned part result initialization genesis initialization data strcture genesis made available hdk new publictoken global conductor addition conductorapi convention example generated token provide example zome functionspatterns request token generate return calling agent level zome function calling application level nodetonode send receive communication zome mixin security capability model useful extramembrane security also intramembrane security crosszome call composibility model includes dropin zomes developer may able see source code get wasm important create ability make calling function zomes subject capability request specific grant work may expand expressivity sign api call may limit agency call made certain zomes