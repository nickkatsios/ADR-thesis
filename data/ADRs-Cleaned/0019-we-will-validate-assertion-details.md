validate assertion detail assertion generated msa look like samlassertion iddcffadbcff issueinstanttz version samlissuer formaturnoasisnamestcsamlnameidformatentityhttpwwwtestrpmsgovuksamlmdsamlissuer dssignaturedssignature samlsubject samlnameid formaturnoasisnamestcsamlnameidformatpersistentexpectedpidsamlnameid samlsubjectconfirmation methodurnoasisnamestcsamlcmbearer samlsubjectconfirmationdata inresponsetorequestidfdccbfccdcb notonoraftertz recipienthttprpendpointcom samlsubjectconfirmation samlsubject samlconditions samlaudiencerestriction samlaudiencerpentitysamlaudience samlaudiencerestriction samlconditions samlauthnstatement authninstanttz samlauthncontext samlauthncontextclassrefurnukgovcabinetofficetcsamlauthncontextlevelsamlauthncontextclassref samlauthncontext samlauthnstatement samlassertion element condition specify restriction assertion treated valid relying party validate thing validate detail msa currently provides see element expecting well throw well validate must exactly one subjectconfirmation must exactly one nameid inside subject subjectconfirmationdata method must bearer there notbefore subjectconfirmationdata must valid must notonorafter subjectconfirmationdata must valid inresponseto must present subjectconfirmationdata must valid condition must present condition notbefore notonorafter must valid condition must contain onetimeuse proxyrestriction element must exactly one audiencerestriction must match entityid well ignore recipient concept already checked audiencerestriction hard vsp check whether correct dont know url running behind consequence assertion must match particular format strict saml specification situation may harder change format without also updating verifyserviceprovider difficult malicious party misuse assertion inappropriate way