event based content tracker alfresco content text extraction work new transform service work alternative evaluation change search service new microservice middle event oriented content tracking finding reference current approach content tracker search service query solr dirty document fetch alfresco content successfully obtained alfresco mark clean eventually get committed index approach modified applies pressure alfresco every call get content taking event based approach content tracker subscribes topic policy specific behaviour allow get extracted content ready currently different alternative considered change search service repository load transformation transform service pause thread requesting transformation content transformed introduce new microservice sits search service transform service content loaded transform service microservice store content search service ingest content tracker consumes content based event document describes explores alternative provide background required produce adr architectural record related topic text extraction work following information extracted alfresco content service alfresco search service component referenced figure alfrescosearch alfresco solr application deployed solr jetty web application solrwar library alfrescoremoteapi rest api layer alfresco content service deployed alfresco tomcat web application alfrescowar library alfrescorepository metadata content storage alfresco content service deployed alfresco tomcat web application alfrescowar library apache tika detection extraction metadata text content deployed alfresco tomcat web application alfrescowar library libreoffice program serverless mode provide content transformation installed locally server direct tcp service usually listening port via jodconverter text extraction process since detailed information content tracker available text extraction process happens inside solrinformationserver class dirty document indexed solrapiclient invoked retrieve text content alfresco repository rest api apisolrtextcontentnodeididpropertyqnamename identifier document database propertyqname identifier property representing content document httpwwwalfrescoorgmodelcontentcontent default class part alfresco solr application request textcontent processed nodecontentget web script alfresco remote api component find right content transformer produce required text content original mime type apache tika local class invocation libreoffice tcp service jodconverter content transformer available transformation performed content transformer stream returned back solrinformationserver indexing process continues note nodecontentget web script deprecated api find right transformer getactivetransformers new transform service work going alternative evaluation quick overview new alfresco transform service provided since transformation performed different microservices named transform engine tengine alfrescodockeralfrescopdfrenderer includes pdfium wrapper named alfresco pdf renderer provide operation pdf file extracting first page alfrescodockerimagemagick includes imagemagick wrapper provide operation image generating thumbnail alfrescodockerlibreoffice includes libreoffice wrapper provide transformation operation source mime type target mime type alfrescodockertika expose apache tika feature mime type transformation component available enterprise release alfresco link text may unavailable community user transform engine dockerized rest api providing transform service renderization operation transform service message router currently working activemq provide transformation request transform engine manage transformation reply transform engine router find right transform engine transformation request depending source target mime type reduce transit content service dockerized shared file store rest api single point storage transformation operation requested source file uploaded shared file store transformation operation performed target file uploaded also shared file store operation consumed source target file removed shared file store component referenced figure tclient currently transformer client requesting transformation operation transform service via jms event shared file store rest api layer share content tclient tengine tservice alfresco transform service route jms event tengines tengine transformation engine provides transformation operation content consuming source shared file store producing target also shared file store currently apache tika libreoffice imagemagick pdf renderer available tengine currently available enterprise release alfresco link text may unavailable community user transformation process tclient uploads source content shared file store rest api invocation retrieve srccontentref tclient creates new transformrequest event srccontentref requested operation tservice consumes event invokes right tengine libreoffice imagemagick pdfrenderer apache tika srccontentref operation requested tengine performs transformation store result shared file store retrieve targetcontentref tservice creates new transformreply event targetcontentref consumed tclient transformed content downloaded shared file store rest api invocation instance downloaded content stored repository new rendition temporary copy shared file store required anymore source target file deleted shared file store operation end successfully note detailed json syntax transform request transform reply available spec transform request reply alternative evaluation different alternative integrating content tracking new transform service described change search service repository load transformation transform service pause thread requesting transformation content transformed component referenced figure alfrescosearch alfresco solr application deployed solr jetty web application solrwar library alfrescoremoteapi rest api layer alfresco content service deployed alfresco tomcat web application alfrescowar library alfrescorepository metadata content storage alfresco content service deployed alfresco tomcat web application alfrescowar library shared file store rest api layer share content tclient tengine tservice alfresco transform service route jms event tengines dockertika rest api layer tengine based tika dockerlibreoffice rest api layer tengine based libreoffice tengine component like tika libreoffice available enterprise release alfresco link text may unavailable community user transformation process solr side code remains unchanged transformation text requested nodecontentget web script point content transformer store source content shared file store retrieve sourceref creates new transform request event consumed transform service transform service routing component find right transform engine tika libreoffice perform invocation sourceref target medium type txt transform engine source content retrieved shared file store sourceref transformation performed result stored shared file store retrieve targetref transform engine creates new transform reply event consumed content transformer content retrieved shared file store targetref original request nodecontentget paused performing transformation content transformer return textcontent stream back response delivered solr source target file deleted shared file store operation end successfully consequence consequence search service expected applying alternative new microservice middle introduce new microservice sits search service transform service content loaded transform service microservice store content search service ingest component referenced figure alfrescosearch alfresco solr application deployed solr jetty web application solrwar library contenttracker new rest api layer based spring boot app dockerizable designed component also publishing transformrequest event consumed transform service alfrescoremoteapi rest api layer alfresco content service deployed alfresco tomcat web application alfrescowar library shared file store rest api layer share content tclient tengine tservice alfresco transform service route jms event tengines dockertika rest api layer tengine based tika dockerlibreoffice rest api layer tengine based libreoffice tengines like tika libreoffice available enterprise release alfresco link text may unavailable community user transformation process new microservice named contenttracker diagram handle transformation text request content tracker service replaces previous nodecontentget web script solrinformationserver invokes contenttracker http rest api start transformation contenttracker invokes repository retrieve source content node remote api store result shared file store retrieve sourceref contenttracker creates new transform request event consumed transform service transform service routing component find right transform engine tika libreoffice perform invocation sourceref target medium type txt transform engine source content retrieved shared file store sourceref transformation performed result stored shared file store retrieve targetref transform engine creates new transform reply event consumed contenttracker content retrieved shared file store targetref original request paused performing transformation contenttracker return textcontent stream back response delivered content tracker source target file deleted shared file store operation end successfully alternative implementation variation scenario adapt indexing flow transform content text async transform request transform reply search service request repo transfer content shared file store search service sends async transform request new transform service search service consumes async transform reply unique shard order update index shard main difference original contenttracker get original content store shared file store sends request repository better term performance consequence new dependency transform service version must included search service compatibility matrix required create switch search service current content tracker based rest api invocation new content tracker including jms event mainly preserve compatibility new component contenttraker must developed component new tclient dockerizable jms ready incoming thread must paused till jms transformreply consumed logic control added current code risk currently transform service supporting several tclients transform service despite story developed exclude alternative tclient supported also sharding environment one indexing tclient required event oriented content tracking content tracker consumes content based event apache kafka solr index require full history event transaction rebuilt scratch message broker storage like activemq currently transform service recommended scenario since amazon providing msk amazon managed streaming kafka apache kafka streaming data store product seems fit better requirement search service apache kafka poc developed order test different requirement apache kafka zookeeper compatibility current stack producing event topic message json format consuming event topic live offset beginning consuming event live topic required regular running platform index request consumed perform indexing operation consuming event offset required provide safe search service restarting indexing system catch event production may happen search service stopping consuming event beginning required rebuilding solr index scratch poc available httpsgithubcomaborroyeventcontenttrackerkafka design new paradigm introduced kafka requires set component provided platform order provide indexation process iclient spring boot app receiving indexing request behaviour rest api invocation activemq message shared file store rest api layer store text file indexed iservice spring boot app listening topic apache kafka process indexrequest message iengine spring boot app receiving rest api invocation perform indexing operation iclient receives new request node txtcontentref indexed produce new indexrequest message apache kafka indexing topic iservice consumes message apache kafka indexing topic invokes iengine txtcontentref iengine retrieves text content file shared file store performs indexation indexer solr updating current offset global value result propagated till iclient provide feedback sample content tracking process component referenced figure onupdatebehaviour iclient tclient component developed part alfresco repository new module alfresco repository component tclient transformation client also iclient indexation client content node updated new transformrequest event transform text published activemq consumed transform service new indexrequest event perform indexation published kafka topic indexation shared file store rest api layer share content tclient tengine transformservice alfresco transform service route jms event tengines eventsearchservice iservice component iservice receiving indexrequest delivered iengine contenttrackerservice iengine component iengine providing indexing logic indexrequest alfrescosearch custom solr code including indexing logic component contenttracker solrinformationserver solrcontentstore transformation process new content updated event repository trigger transformrequest event text consumed tservice saving first original file shared file store tservice performed transformation transformreply event produced consumed eventsearchservice store reference targetref transformed content also issuing transformation event new indexrequest event triggered kafka topic indexation consumed eventsearchservice eventsearchservice transformreply matching indexrequest indexation process started invoking contenttrackerservice rest api targetref txid contenttrackerservice start indexation process txid current logic reply sent back iclient current kafka offset must updated iengine order prepared catching repository rebuilding purpose consequence new dependency transform service version must included search service compatibility matrix new dependency apache kafka version must included search service compatibility matrix required create switch search service current content tracker based rest api invocation new content tracker including jms event mainly preserve compatibility new component eventsearchservice must developed component new iservice dockerizable jms kafka ready new component contenttrackerservice must developed component new iengine dockerizable providing rest api since new indexation repository apache kafka transaction concept must translated kafka transaction system provide right offset consumer reindexing catching indexation behind content service update risk currently transform service supporting several tclients transform service despite story developed exclude alternative tclient supported also sharding environment one indexing tclient required finding apache kafka work inside deployment strategy alone together one transform service apachemq apache kafka topic feed name event published topic kafka cluster maintains partitioned log partition ordered immutable sequence event continually appended toa structured commit log record partition assigned sequential number called offset uniquely identifies record within partition offset iengines identify order recovering previous indexation kafka cluster durably persists published record whether consumed kafka performance effectively constant respect data size storing data long time even forever problem apache kafka supported amazon right product store indexing event also amazon deployment according apache kafka better throughput max message size text content stored within event reference content tracker jodconverter pdfium alfresco pdf renderer source code currently available enteprise user imagemagick apache tika pausablethreadpoolexecutor