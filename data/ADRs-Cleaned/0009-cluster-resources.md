declarative definition cluster scoped resource deciders nnd anishasthana humairak tumido technical story issue issue problem statement full gitops driven approach decided take previous adrs make face additional challenge deploying cluster scoped resource resource like namespace group subscription customresourcedefinitions etc defined declaratively deployable via argocd allow user optional encryption layer sensitive propertiesobjects may considered pii risk see adr additionally resulting layout flexible enough migrating project cluster andor extending project multiple cluster simple enough driver declarative manifest git repo deployable via argocd cluster admin permission common layout adopted various downstreams target cluster deployment provides consistent secret sensitive data management simplifies application onboarding argocd driven deployment single allows collocate cluster scoped resource along supplementary namespace scoped resource considered narrow scoped requirement driver leaf choose however execution great importance namespaces application deployed via argocd clusterscope application deployed via argocd deploy cluster scoped resource part openshift bootstrap repository outcome choosen clusterscope application deployed via argocd application live within githubcomoperatefirstapps repository support various downstreams manner defined adr adr proposed layout clusterscope application clusterscope base clusterrolebindings crds subscription group namespaces foo bar kustomizationyaml namespaceyaml component projectadminrbac baz qux kustomizationyaml rbacyaml overlay environment environment group example encrypted patch bazencyaml kustomizationyaml secretgeneratoryaml environment groupuserpatchyaml example plaintext patch kustomizationyaml general guideline folder within base corresponds clusterscoped resource kind folder component contains mixandmatch resource depends target environment kustomize component meant imported kustomization exception resource kind requires component kind kept base selectively picked overlay example namespaces selected base namespace includes rbac component declarative description managed environment located within overlay folder environment pick base resource deploy patch environment specific content example environment kustomization would result deployment selected namespaces rolebinding since namespace rbac component yaml apiversion kustomizeconfigksiovbeta kind kustomization resource basenamespacesodhoperator basenamespacesopfargo positive consequence environment specific overlay contains single kustomizationyaml file contains list applied resource list namespaces group etc also include lightweight patch make apparent get deployed given environment first sight make easy review argocd application defined environment overlay ensuring mapping overlay cluster provides easy mixandmatch capability maintaining single source truth resource single argocd application resource whitelist allowing deployment cluster scoped resource required exist per target cluster negative consequence component content cant environment specific example cant apply different value namespace resource quota quota component environmentspecific templating shared component possibly worked around patch overlay rejected namespaces application deployed via argocd adhock implementation namespaces application invented initial support cluster scoped resource focusing namespaces bundling resource resource kind like operator subscription supposed stored within openshift bootstrap repository proposed layout namespaces base foo bar kustomizationyaml namespaceyaml rbacyaml overlay environment environment kustomizationyaml baz example additional environment specific namespace groupencyaml kustomizationyaml namespaceyaml rbacyaml secretgeneratoryaml bar example namespace overlayed base kustomizationyaml namespace shared cluster expected hosted folder within base supplementary namespaced resource requires cluster admin permission collocated well example rolebindings clusterroles subscription operator etc namespace environment cluster specific expected live within environment overlay disadvantage verbose since requires many file folder created accommodating minor change error prone due verbosity copypaste nature lacking clear direction resource kind namespace group rolebindings namespace environment specific user want share another environment different cluster lot file moved around deploy cluster scoped resource part openshift bootstrap repository stick current implementation moc environment replicate setup others requires environment provide openshift bootstrap configuration repository either referenced environment specific argocd app resource applied part cluster scheduling bootstrap repository disadvantage sharing resource environment limited would require remotely reference environment repository lacking unified sensitive data management