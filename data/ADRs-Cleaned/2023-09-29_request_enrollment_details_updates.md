revisiting enrollment detail continues work started initial host detail author seph directionless last several year roughly since late weve seen occasional problem starting internally weve called monterey bug information link github issue httpsgithubcomkolidelauncherissues never managed diagnose reproduced small part nothing hold leading theory somehow related runtime complexity osquery startup time thrift socket contention may multiple related unrelated issue play additional complexity stem original implementation getenrollmentdetails osquery socket cannot run osquery started simultaneously launcher trying register extension osquery trying enroll simplify startup ordering reduce socket contention gather enrollment detail via execing osquery semantically fairly simple change query osquery consequence incur exec call startup return gain several benefit decouple enrollment detail main osquery startup reduce contention socket early startup enrollment longer circular dependency enables future work completely pull enrollment launcher